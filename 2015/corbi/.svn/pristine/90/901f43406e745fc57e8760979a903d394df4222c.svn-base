{\rtf1\ansi\ansicpg0\deff0\deflang1033\deflangfe1040{\fonttbl {\f0\fnil\fprq0\fcharset1 Courier New;}{\f1\fnil\fprq0\fcharset1 Courier New;}{\f2\fnil\fprq0\fcharset1 Courier New;}{\f3\fnil\fprq0\fcharset1 Courier New;}{\f4\fnil\fprq0\fcharset1 Courier New;}{\f5\fnil\fprq0\fcharset1 Courier New;}{\f6\fnil\fprq0\fcharset1 Courier New;}{\f7\fnil\fprq0\fcharset1 Courier New;}{\f8\fnil\fprq0\fcharset1 Courier New;}{\f9\fnil\fprq0\fcharset1 Courier New;}{\f10\fnil\fprq0\fcharset1 Courier New;}}
{\colortbl ;\red255\green0\blue0;\red0\green0\blue128;\red0\green0\blue255;\red0\green128\blue0;\red0\green0\blue0;\red0\green0\blue0;\red0\green0\blue0;\red0\green0\blue0;\red0\green0\blue255;\red0\green0\blue0;\red0\green0\blue255;}
{\info{\author CnPack Source2RTF Wizard (http://www.cnpack.org)}{\creatim\yr2016\mo3\dy8\hr11\min41}{\comment CnPack Source2RTF Wizard (http://www.cnpack.org)}}
{\*\generator Msftedit 5.41.15.1507;}\viewkind4\uc1\pard\lang1040\b\cf6\f5\fs20 unit\f0\cf0\b0  \cf5\f4\fs20 Classifiche\f0\cf0 \cf10\f9\fs20 ;\f0\cf0          \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //05/02/2016\f0\cf0\i0 
\par   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //in questa unit\u224?vi sono righe di codice non utilizzate ma come commenti\f0\cf0\i0 
\par \b\cf6\f5\fs20 interface\f0\cf0\b0 
\par 
\par \b\cf6\f5\fs20 uses\f0\cf0\b0 
\par   \cf5\f4\fs20 Winapi\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Windows\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf5\f4\fs20 Winapi\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Messages\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf5\f4\fs20 System\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 SysUtils\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf5\f4\fs20 System\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Variants\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf5\f4\fs20 System\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Classes\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 
\par   \cf5\f4\fs20 Vcl\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Graphics\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 Vcl\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Controls\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf5\f4\fs20 Vcl\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Forms\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf5\f4\fs20 Vcl\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Dialogs\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf5\f4\fs20 Vcl\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 StdCtrls\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf5\f4\fs20 Vcl\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 CheckLst\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 
\par   \cf5\f4\fs20 Vcl\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Grids\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 System\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 DateUtils\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 Data\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 DB\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf5\f4\fs20 Vcl\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 DBGrids\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf5\f4\fs20 Vcl\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 DBCtrls\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf5\f4\fs20 Vcl\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ExtCtrls\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 
\par   \cf5\f4\fs20 ABSMain\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf5\f4\fs20 frxClass\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf5\f4\fs20 frxDBSet\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 Datasnap\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 DBClient\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf5\f4\fs20 Datasnap\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Provider\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par \b\cf6\f5\fs20 type\f0\cf0\b0 
\par   \cf5\f4\fs20 TForm8\f0\cf0  \cf10\f9\fs20 =\f0\cf0  \b\cf6\f5\fs20 class\f0\cf0\b0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 TForm\f0\cf0 \cf10\f9\fs20 )\f0\cf0 
\par     \cf5\f4\fs20 Esci\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TButton\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 DBGrid8\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TDBGrid\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 DataSource8\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TDataSource\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Button1\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TButton\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Button2\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TButton\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Button3\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TButton\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Label1\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TLabel\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 ListBox8\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TListBox\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Button4\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TButton\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Button6\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TButton\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Shape1\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TShape\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Label3\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TLabel\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Label4\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TLabel\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Label5\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TLabel\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Shape2\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TShape\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Shape3\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TShape\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Button7\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TButton\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 RadioButton1\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TRadioButton\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 RadioButton2\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TRadioButton\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 RadioButton3\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TRadioButton\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 ComboBox1\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TComboBox\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Label6\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TLabel\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TABSQuery\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 DataSourceQry\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TDataSource\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TABSTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TABSQuery\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 frxReport8\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TfrxReport\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 frxDBDataset85\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TfrxDBDataset\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 ABSQuery83\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TABSQuery\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TABSTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 DataSourceQry2\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TDataSource\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 ABSTable18\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TABSTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 frxReport8D\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TfrxReport\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 frxDBDataset8D\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TfrxDBDataset\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 frxReport16\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TfrxReport\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 frxDBDataset16\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TfrxDBDataset\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 frxReport16T\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TfrxReport\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 frxDBDataset16T\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TfrxDBDataset\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 frxReport16T2\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TfrxReport\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 frxDBDataset16t2\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TfrxDBDataset\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 ABSQueryRep\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TABSQuery\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TABSTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 ABSTable16R\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \cf5\f4\fs20 TABSTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 frxReportTot\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TfrxReport\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 frxDBDatasetTot\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TfrxDBDataset\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Bevel1\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TBevel\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 frxReportR\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TfrxReport\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 frxDBDatasetR\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TfrxDBDataset\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 ABSQueryR\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TABSQuery\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Label2\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TLabel\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 ABSTable20\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TABSTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 frxReportCompl\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TfrxReport\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 frxDBDatasetCompl\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TfrxDBDataset\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \b\cf6\f5\fs20 procedure\f0\cf0\b0  \cf5\f4\fs20 FormCreate\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Sender\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TObject\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par     \b\cf6\f5\fs20 procedure\f0\cf0\b0  \cf5\f4\fs20 EsciClick\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Sender\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TObject\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par     \b\cf6\f5\fs20 procedure\f0\cf0\b0  \cf5\f4\fs20 Button1Click\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Sender\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TObject\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par     \b\cf6\f5\fs20 procedure\f0\cf0\b0  \cf5\f4\fs20 DBGrid8CellClick\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Column\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TColumn\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par     \b\cf6\f5\fs20 procedure\f0\cf0\b0  \cf5\f4\fs20 Button2Click\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Sender\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TObject\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par     \b\cf6\f5\fs20 procedure\f0\cf0\b0  \cf5\f4\fs20 Button3Click\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Sender\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TObject\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par     \b\cf6\f5\fs20 procedure\f0\cf0\b0  \cf5\f4\fs20 Button4Click\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Sender\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TObject\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par     \b\cf6\f5\fs20 procedure\f0\cf0\b0  \cf5\f4\fs20 Button6Click\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Sender\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TObject\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par     \b\cf6\f5\fs20 procedure\f0\cf0\b0  \cf5\f4\fs20 Calcola\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Sender\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TObject\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par     \b\cf6\f5\fs20 procedure\f0\cf0\b0  \cf5\f4\fs20 Button7Click\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Sender\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TObject\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par   \b\cf6\f5\fs20 private\f0\cf0\b0 
\par     \i\cf2\f1\fs20 \{ Private declarations \}\f0\cf0\i0 
\par   \b\cf6\f5\fs20 public\f0\cf0\b0 
\par     \i\cf2\f1\fs20 \{ Public declarations \}\f0\cf0\i0 
\par   \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par \b\cf6\f5\fs20 var\f0\cf0\b0 
\par   \cf5\f4\fs20 Form8\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TForm8\f0\cf0 \cf10\f9\fs20 ;\f0\cf0                                \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //ArGare Gare selezionate\f0\cf0\i0 
\par   \cf5\f4\fs20 ClassFlg\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \cf5\f4\fs20 Boolean\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 True\f0\cf0 \cf10\f9\fs20 ;\f0\cf0                        \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //ArDspl  Discipline selezionate\f0\cf0\i0 
\par   \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 ArDspl\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 ArCat\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \b\cf6\f5\fs20 array\f0\cf0\b0  \b\cf6\f5\fs20 of\f0\cf0\b0  \cf5\f4\fs20 Integer\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 \i\cf2\f1\fs20 //ArCat  Categorie selezionate\f0\cf0\i0 
\par   \cf5\f4\fs20 SelGare\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \cf5\f4\fs20 Boolean\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 False\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 SelDspl\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \cf5\f4\fs20 Boolean\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 False\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 ClassDp\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \cf5\f4\fs20 Boolean\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 False\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 idx\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mom\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 momd\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 MaxIdxGare\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 MaxIdxDspl\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 MaxIdxCat\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \cf5\f4\fs20 Integer\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par \b\cf6\f5\fs20 implementation\f0\cf0\b0 
\par \b\cf6\f5\fs20 uses\f0\cf0\b0 
\par \cf5\f4\fs20 Console1\f0\cf0  \cf10\f9\fs20 ;\f0\cf0 
\par \cf4\f3\fs20 \{$R *.dfm\}\f0\cf0 
\par \cf4\f3\fs20 \{$D+\}\f0\cf0 
\par \b\cf6\f5\fs20 procedure\f0\cf0\b0  \cf5\f4\fs20 TForm8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FormCreate\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Sender\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TObject\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par   \cf5\f4\fs20 ClassFlg\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 False\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // Form2.ABSTable3.TableName:='SelezioneGare';\f0\cf0\i0 
\par   \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Edit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // Form2.ABSTable3D.TableName:='SelezioneDSPL';\f0\cf0\i0 
\par   \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Edit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 TableName\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'Classifica'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Edit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 ABSTable16R\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 TableName\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'R16R'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 ABSTable16R\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 ABSTable20\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 TableName\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'repDSPL'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // ABSTable20.Open;\f0\cf0\i0 
\par   \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable6\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 >\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par    \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par      \cf5\f4\fs20 TDateTimeField\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Form8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TAME1'\f0\cf0 \cf10\f9\fs20 )).\f0\cf0 \cf5\f4\fs20 DisplayFormat\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \cf5\f4\fs20 TDateTimeField\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Form8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TBME2'\f0\cf0 \cf10\f9\fs20 )).\f0\cf0 \cf5\f4\fs20 DisplayFormat\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \cf5\f4\fs20 TDateTimeField\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Form8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'PEN'\f0\cf0 \cf10\f9\fs20 )).\f0\cf0 \cf5\f4\fs20 DisplayFormat\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par    \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 TableName\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'Ranking'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 ABSTable18\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 TableName\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'Temp8'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable5\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable4\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 SetLength\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf7\f6\fs20 20\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par   \cf5\f4\fs20 SetLength\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArDspl\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf7\f6\fs20 20\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par   \cf5\f4\fs20 SetLength\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArCat\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf7\f6\fs20 10\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par   \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 TableName\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'totale'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 Shape1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Brush\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 Shape2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Brush\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 Shape3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Brush\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 RadioButton1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 RadioButton2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \cf5\f4\fs20 RadioButton3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par \b\cf6\f5\fs20 procedure\f0\cf0\b0  \cf5\f4\fs20 TForm8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Button1Click\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Sender\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TObject\f0\cf0 \cf10\f9\fs20 );\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Seleziona le gare\f0\cf0\i0 
\par \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par      \cf5\f4\fs20 DataSource8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 DataSet\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable5\f0\cf0 \cf10\f9\fs20 ;\f0\cf0         \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //display gare su dbgrid\f0\cf0\i0 
\par      \cf5\f4\fs20 DBGrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 DataSource\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 DataSource8\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \cf5\f4\fs20 DBGrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Width\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 376\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \cf5\f4\fs20 DBGrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Columns\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 ].\f0\cf0 \cf5\f4\fs20 Width\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 44\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \cf5\f4\fs20 DBGrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Columns\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ].\f0\cf0 \cf5\f4\fs20 Width\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 64\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \cf5\f4\fs20 DBGrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Columns\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf7\f6\fs20 2\f0\cf0 \cf10\f9\fs20 ].\f0\cf0 \cf5\f4\fs20 Width\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 228\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \cf5\f4\fs20 SelGare\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 True\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \cf5\f4\fs20 SelDspl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 False\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \cf5\f4\fs20 SetLength\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par      \cf5\f4\fs20 SetLength\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf7\f6\fs20 20\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par      \cf5\f4\fs20 Shape1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Brush\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par \b\cf6\f5\fs20 procedure\f0\cf0\b0  \cf5\f4\fs20 TForm8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 DBGrid8CellClick\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Column\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TColumn\f0\cf0 \cf10\f9\fs20 );\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Inserisci-Scegli\f0\cf0\i0 
\par \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par     \cf5\f4\fs20 ListBox8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Items\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Add\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 DBGrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Fields\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 ].\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par     \cf5\f4\fs20 Self\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ActiveControl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \b\cf6\f5\fs20 nil\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par \b\cf6\f5\fs20 procedure\f0\cf0\b0  \cf5\f4\fs20 TForm8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Button2Click\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Sender\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TObject\f0\cf0 \cf10\f9\fs20 );\f0\cf0     \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Rimuovere\f0\cf0\i0 
\par \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par     \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ListBox8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Items\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Count\f0\cf0  \cf10\f9\fs20 >\f0\cf0  \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //verifica che  non c'\u232? selezionato\f0\cf0\i0 
\par       \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par           \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ListBox8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Itemindex\f0\cf0  \cf10\f9\fs20 =-\f0\cf0 \cf7\f6\fs20 1\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par            \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par             \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Nessun elemento selezionato'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par             \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par       \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par    \cf5\f4\fs20 ListBox8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 DeleteSelected\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par \b\cf6\f5\fs20 procedure\f0\cf0\b0  \cf5\f4\fs20 TForm8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Button3Click\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Sender\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TObject\f0\cf0 \cf10\f9\fs20 );\f0\cf0     \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Salva i valori negli array\f0\cf0\i0 
\par \b\cf6\f5\fs20 var\f0\cf0\b0 
\par \cf5\f4\fs20 k\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \cf5\f4\fs20 ShortInt\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par \cf5\f4\fs20 kk\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \cf5\f4\fs20 Integer\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par     \b\cf6\f5\fs20 for\f0\cf0\b0  \cf5\f4\fs20 i\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 ListBox8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Items\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Count\f0\cf0  \cf10\f9\fs20 -\f0\cf0  \cf7\f6\fs20 1\f0\cf0  \b\cf6\f5\fs20 downto\f0\cf0\b0  \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //toglie gli spazi vuoti\f0\cf0\i0 
\par      \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par       \b\cf6\f5\fs20 if\f0\cf0\b0  \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Trim\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ListBox8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Items\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 ])\f0\cf0  \cf10\f9\fs20 =\f0\cf0  \cf9\f8\fs20 ''\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par          \cf5\f4\fs20 ListBox8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Items\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Delete\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par      \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par  \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 MessageDlg\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Confermi gli elementi scelti ?'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mtconfirmation\f0\cf0 \cf10\f9\fs20 ,[\f0\cf0 \cf5\f4\fs20 mbYes\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mbNo\f0\cf0 \cf10\f9\fs20 ],\f0\cf0  \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0 
\par   \cf10\f9\fs20 =\f0\cf0  \cf5\f4\fs20 mrNo\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par        \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par           \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 SelGare\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 True\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0          \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // verifica la scelta\f0\cf0\i0 
\par             \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par               \cf5\f4\fs20 SetLength\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par               \cf5\f4\fs20 SetLength\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf7\f6\fs20 20\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par               \cf5\f4\fs20 Shape1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Brush\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par           \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 SelDspl\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 True\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par             \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par               \cf5\f4\fs20 SetLength\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArDspl\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par               \cf5\f4\fs20 SetLength\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArDspl\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf7\f6\fs20 20\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par               \cf5\f4\fs20 Shape2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Brush\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 ListBox8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Clear\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par     \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 SelGare\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 True\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0                         \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Salva le Gare scelte nell'ARRAY\f0\cf0\i0 
\par       \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par          \b\cf6\f5\fs20 for\f0\cf0\b0  \cf5\f4\fs20 k\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 to\f0\cf0\b0  \cf5\f4\fs20 ListBox8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Items\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Count\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par            \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par              \cf5\f4\fs20 kk\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 StrToInt\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ListBox8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Items\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 k\f0\cf0 \cf10\f9\fs20 ]);\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // NOTA BENE gli array non consentono\f0\cf0\i0 
\par              \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 k\f0\cf0 \cf10\f9\fs20 ]:=\f0\cf0  \cf5\f4\fs20 kk\f0\cf0 \cf10\f9\fs20 ;\f0\cf0                    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // di elimare il passaggio tramite kk\f0\cf0\i0 
\par            \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par            \b\cf6\f5\fs20 for\f0\cf0\b0  \cf5\f4\fs20 i\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 to\f0\cf0\b0  \cf5\f4\fs20 High\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //sistema per verificare se l'array \u232?vuoto\f0\cf0\i0 
\par        \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 ]=\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0          \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // va al primo vuoto e segna l'indice precedente\f0\cf0\i0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par           \cf5\f4\fs20 mom\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 MaxIdxGare\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 mom\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 Break\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par        \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 mom\f0\cf0 \cf10\f9\fs20 =-\f0\cf0 \cf7\f6\fs20 1\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par          \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Non vi sono elementi da salvare ! - ripeti'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par          \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0  \b\cf6\f5\fs20 else\f0\cf0\b0                                         \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //reinizializza\f0\cf0\i0 
\par              \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 ' Dati salvati'\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 #13\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 'Se Classifichi per Gare: inserisci Gruppo e Categoria'\f0\cf0 
\par                \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 #13#10#10\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 'Se Classifichi per Discipline, selezionala/e'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                \cf5\f4\fs20 Shape1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Brush\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clLime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \b\cf6\f5\fs20 end\f0\cf0\b0  \cf10\f9\fs20 ;\f0\cf0 
\par 
\par           \b\cf6\f5\fs20 for\f0\cf0\b0  \cf5\f4\fs20 k\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 ListBox8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Items\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Count\f0\cf0  \cf10\f9\fs20 -\f0\cf0  \cf7\f6\fs20 1\f0\cf0  \b\cf6\f5\fs20 downto\f0\cf0\b0  \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //resetta la listBox\f0\cf0\i0 
\par            \cf5\f4\fs20 ListBox8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Items\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Delete\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 k\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par            \cf5\f4\fs20 SelGare\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 False\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par     \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 SelDspl\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 True\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0                      \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // memorizza le discipline\f0\cf0\i0 
\par       \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par          \b\cf6\f5\fs20 for\f0\cf0\b0  \cf5\f4\fs20 k\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 to\f0\cf0\b0  \cf5\f4\fs20 ListBox8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Items\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Count\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par            \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par              \cf5\f4\fs20 kk\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 StrToInt\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ListBox8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Items\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 k\f0\cf0 \cf10\f9\fs20 ]);\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // NOTA BENE gli array non consentono\f0\cf0\i0 
\par              \cf5\f4\fs20 ArDspl\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 k\f0\cf0 \cf10\f9\fs20 ]:=\f0\cf0  \cf5\f4\fs20 kk\f0\cf0 \cf10\f9\fs20 ;\f0\cf0                    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // di elimare il passaggio tramite kk\f0\cf0\i0 
\par            \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par            \b\cf6\f5\fs20 for\f0\cf0\b0  \cf5\f4\fs20 i\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 to\f0\cf0\b0  \cf5\f4\fs20 High\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArDspl\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0     \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Questo \u232?l'unico sistema per verificare\f0\cf0\i0 
\par        \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ArDspl\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 ]=\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0                 \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // se l'array \u232?vuoto\f0\cf0\i0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par           \cf5\f4\fs20 mom\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 MaxIdxDspl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 mom\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 Break\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par        \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 mom\f0\cf0 \cf10\f9\fs20 =-\f0\cf0 \cf7\f6\fs20 1\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par          \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Non vi sono elementi da salvare ! - ripeti'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par          \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0  \b\cf6\f5\fs20 else\f0\cf0\b0                                         \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //reinizializza\f0\cf0\i0 
\par              \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 ' Dati salvati'\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 #13\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 'Inserisci la Categoria'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                \cf5\f4\fs20 Shape2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Brush\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clLime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \b\cf6\f5\fs20 end\f0\cf0\b0  \cf10\f9\fs20 ;\f0\cf0 
\par          \b\cf6\f5\fs20 for\f0\cf0\b0  \cf5\f4\fs20 k\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 ListBox8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Items\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Count\f0\cf0  \cf10\f9\fs20 -\f0\cf0  \cf7\f6\fs20 1\f0\cf0  \b\cf6\f5\fs20 downto\f0\cf0\b0  \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //resetta la listBox\f0\cf0\i0 
\par            \cf5\f4\fs20 ListBox8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Items\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Delete\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 k\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par            \cf5\f4\fs20 SelDspl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 False\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par       \cf5\f4\fs20 DBGrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 DataSource\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 DataSet\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0        \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //svuota la dbgrid\f0\cf0\i0 
\par       \cf5\f4\fs20 DBGrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Refresh\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par \b\cf6\f5\fs20 procedure\f0\cf0\b0  \cf5\f4\fs20 TForm8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Button4Click\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Sender\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TObject\f0\cf0 \cf10\f9\fs20 );\f0\cf0       \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Seleziona le discipline\f0\cf0\i0 
\par \b\cf6\f5\fs20 var\f0\cf0\b0 
\par \cf5\f4\fs20 k\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \cf5\f4\fs20 ShortInt\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par     \b\cf6\f5\fs20 for\f0\cf0\b0  \cf5\f4\fs20 k\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 ListBox8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Items\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Count\f0\cf0  \cf10\f9\fs20 -\f0\cf0  \cf7\f6\fs20 1\f0\cf0  \b\cf6\f5\fs20 downto\f0\cf0\b0  \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //resetta la listBox\f0\cf0\i0 
\par            \cf5\f4\fs20 ListBox8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Items\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Delete\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 k\f0\cf0 \cf10\f9\fs20 );\f0\cf0         \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //nel caso fosse gi\u224?inserita una gara\f0\cf0\i0 
\par            \cf5\f4\fs20 SelGare\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 False\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 DataSource8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 DataSet\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable4\f0\cf0 \cf10\f9\fs20 ;\f0\cf0         \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //display gare su dbgrid\f0\cf0\i0 
\par      \cf5\f4\fs20 DBGrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 DataSource\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 DataSource8\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \cf5\f4\fs20 DBGrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Width\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 376\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \cf5\f4\fs20 DBGrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Columns\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 ].\f0\cf0 \cf5\f4\fs20 Width\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 44\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \cf5\f4\fs20 DBGrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Columns\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ].\f0\cf0 \cf5\f4\fs20 Width\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 241\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \cf5\f4\fs20 DBGrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Columns\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf7\f6\fs20 2\f0\cf0 \cf10\f9\fs20 ].\f0\cf0 \cf5\f4\fs20 Width\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 50\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \cf5\f4\fs20 Shape2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Brush\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \cf5\f4\fs20 SelDspl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 True\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \cf5\f4\fs20 SelGare\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 False\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \cf5\f4\fs20 SetLength\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArDspl\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par      \cf5\f4\fs20 SetLength\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArDspl\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf7\f6\fs20 20\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par      \b\cf6\f5\fs20 for\f0\cf0\b0  \cf5\f4\fs20 i\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 to\f0\cf0\b0  \cf5\f4\fs20 High\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Controlla che le gare siano state indicate\f0\cf0\i0 
\par       \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 ]=\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par           \cf5\f4\fs20 mom\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //mom = all'ultimo elemento dell'array memorizzato\f0\cf0\i0 
\par           \cf5\f4\fs20 Break\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par       \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 mom\f0\cf0 \cf10\f9\fs20 =-\f0\cf0 \cf7\f6\fs20 1\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par           \cf5\f4\fs20 Shape1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Brush\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Scegli prima una o pi\u249?gare'\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 #13\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 '   e salva'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par           \cf5\f4\fs20 DBGrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 DataSource\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 DataSet\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0        \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //svuota la dbgrid\f0\cf0\i0 
\par           \cf5\f4\fs20 DBGrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Refresh\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par \b\cf6\f5\fs20 procedure\f0\cf0\b0  \cf5\f4\fs20 TForm8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Button6Click\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Sender\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TObject\f0\cf0 \cf10\f9\fs20 );\f0\cf0       \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // CLASSIFICARE  PER GARE\f0\cf0\i0 
\par \b\cf6\f5\fs20 var\f0\cf0\b0 
\par \cf5\f4\fs20 garesi\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 dsplsi\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 trovato\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \cf5\f4\fs20 Boolean\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \b\cf6\f5\fs20 string\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par \cf5\f4\fs20 Cgara\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 Cdspl\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \cf5\f4\fs20 Integer\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par     \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable5\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Cgara\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Cdspl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //resetta la tabella gare selezionate\f0\cf0\i0 
\par     \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \b\cf6\f5\fs20 for\f0\cf0\b0  \cf5\f4\fs20 i\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 to\f0\cf0\b0  \cf5\f4\fs20 High\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par       \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 ]=\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par           \cf5\f4\fs20 mom\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //mom = all'ultimo elemento dell'array memorizzato\f0\cf0\i0 
\par           \cf5\f4\fs20 Break\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par       \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 mom\f0\cf0 \cf10\f9\fs20 =-\f0\cf0 \cf7\f6\fs20 1\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par           \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Non vi sono elementi memorizzati ! - ripeti'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par           \cf5\f4\fs20 Shape1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Brush\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par     \b\cf6\f5\fs20 for\f0\cf0\b0  \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 to\f0\cf0\b0  \cf5\f4\fs20 mom\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0      \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //crea la tabella 3\f0\cf0\i0 
\par       \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par        \cf5\f4\fs20 idx\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 ];\f0\cf0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Trasferisce i dati dall'Array alla Tabella\f0\cf0\i0 
\par        \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Insert\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Codice'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 idx\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 garesi\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable5\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Locate\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 idx\f0\cf0 \cf10\f9\fs20 ,[]);\f0\cf0 
\par        \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Descrizione'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                    \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable5\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'LUOGO'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Post\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par      \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 comboBox1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ItemIndex\f0\cf0 \cf10\f9\fs20 =-\f0\cf0 \cf7\f6\fs20 1\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0      \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //verifica Categoria\f0\cf0\i0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par            \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Devi scegliere una Categoria'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par            \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0  \b\cf6\f5\fs20 else\f0\cf0\b0 
\par      \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par        \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 MessageDlg\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Confermi di effettuare la classifica per la Categoria '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 comboBox1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 '  ?'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 
\par          \cf5\f4\fs20 mtconfirmation\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 mbYes\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mbNo\f0\cf0 \cf10\f9\fs20 ],\f0\cf0  \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \cf10\f9\fs20 =\f0\cf0  \cf5\f4\fs20 mrNo\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par           \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par            \cf5\f4\fs20 Shape3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Brush\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 Exit\f0\cf0  \cf10\f9\fs20 ;\f0\cf0 
\par            \b\cf6\f5\fs20 end\f0\cf0\b0  \b\cf6\f5\fs20 else\f0\cf0\b0 
\par          \cf5\f4\fs20 shape3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Brush\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 clLime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Verifica esistenza Gruppo\f0\cf0\i0 
\par     \b\cf6\f5\fs20 if\f0\cf0\b0  \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 RadioButton2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Checked\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 False\f0\cf0 \cf10\f9\fs20 )\f0\cf0 \b\cf6\f5\fs20 and\f0\cf0\b0  \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 RadioButton1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Checked\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 False\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \b\cf6\f5\fs20 and\f0\cf0\b0  \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 RadioButton3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Checked\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 False\f0\cf0  \cf10\f9\fs20 )\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par       \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par        \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Devi scegliere un GRUPPO'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par        \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par                  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //DataSource8 \u232?associato alla tabella Gare Selezionate\f0\cf0\i0 
\par      \cf5\f4\fs20 DataSource8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 DataSet\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 ;\f0\cf0         \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //display gare su dbgrid\f0\cf0\i0 
\par      \cf5\f4\fs20 DBGrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 DataSource\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 DataSource8\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \cf5\f4\fs20 DBGrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Width\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 376\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \cf5\f4\fs20 DBGrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Columns\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 ].\f0\cf0 \cf5\f4\fs20 Width\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 44\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \cf5\f4\fs20 DBGrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Columns\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ].\f0\cf0 \cf5\f4\fs20 Width\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 291\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 MessageDlg\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Confermi di effettuare la classifica come selezionato?'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 
\par       \cf5\f4\fs20 mtconfirmation\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 mbYes\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mbNo\f0\cf0 \cf10\f9\fs20 ],\f0\cf0  \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \cf10\f9\fs20 =\f0\cf0  \cf5\f4\fs20 mrNo\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par       \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par         \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \cf5\f4\fs20 Shape1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Brush\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \cf5\f4\fs20 SetLength\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 );\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //azzera l'array delle Gare non confermando la scelta\f0\cf0\i0 
\par         \cf5\f4\fs20 SetLength\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf7\f6\fs20 20\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par         \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par          \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //GRUPPO BASE\f0\cf0\i0 
\par      \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 RadioButton1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Checked\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 True\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par         \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 MessageDlg\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Confermi di effettuare la classifica sul Gruppo Base ?'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 
\par            \cf5\f4\fs20 mtconfirmation\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 mbYes\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mbNo\f0\cf0 \cf10\f9\fs20 ],\f0\cf0  \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \cf10\f9\fs20 =\f0\cf0  \cf5\f4\fs20 mrNo\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par           \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Cambia il Gruppo'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par           \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0  \b\cf6\f5\fs20 else\f0\cf0\b0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //converte l'array delle gare in string per il Query\f0\cf0\i0 
\par            \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable6\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par                \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                  \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Attenzione il Gruppo scelto non contiene discipline !'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                  \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 '('\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \b\cf6\f5\fs20 for\f0\cf0\b0  \cf5\f4\fs20 i\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 to\f0\cf0\b0  \cf5\f4\fs20 MaxIdxGare\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par                \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 ])+\f0\cf0 \cf9\f8\fs20 ','\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 MaxIdxGare\f0\cf0 \cf10\f9\fs20 ]);\f0\cf0 
\par                \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 ')'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par             \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQuery80\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0      \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Estrae dal Base le discipline gruppo Base\f0\cf0\i0 
\par               \b\cf6\f5\fs20 begin\f0\cf0\b0                 \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //per tutte le gare indicate e estrae le\f0\cf0\i0 
\par                 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0              \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // coppie di valori n.gara e n.disciplina\f0\cf0\i0 
\par                 \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'Select * from Base where CODGA IN '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //dall'ARRAY\f0\cf0\i0 
\par                 \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par              \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par                \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                  \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Attenzione il Gruppo scelto non contiene discipline !'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                  \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Fase di raccolta record da classificare in T15 Classifica\f0\cf0\i0 
\par            \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 >\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0     \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Azzero la tabella Classifica\f0\cf0\i0 
\par             \b\cf6\f5\fs20 begin\f0\cf0\b0                              \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // preesistente per non causare\f0\cf0\i0 
\par               \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0                \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // problemi di indice unique\f0\cf0\i0 
\par               \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //era "last" ?\f0\cf0\i0 
\par            \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //ABSQuery80 \u232?una tabella con gare e discipline\f0\cf0\i0 
\par            \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EOF\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0             \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // selezionate\f0\cf0\i0 
\par              \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par               \cf5\f4\fs20 Cgara\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \cf5\f4\fs20 Cdspl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQuery85\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0      \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Estrae dalle Gare le discipline da classif\f0\cf0\i0 
\par                  \b\cf6\f5\fs20 begin\f0\cf0\b0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Costruisce Classifica con tutti i record gare e discipline\f0\cf0\i0 
\par                   \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //selezionate e gli Atleti che le hanno in comune\f0\cf0\i0 
\par                   \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'INSERT INTO Classifica SELECT * From Gara where CODGA='\f0\cf0 
\par                   \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Cgara\f0\cf0 \cf10\f9\fs20 ))+\f0\cf0 \cf9\f8\fs20 ' AND CODDSPL='\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Cdspl\f0\cf0 \cf10\f9\fs20 ))\f0\cf0 
\par                   \cf10\f9\fs20 +\f0\cf0  \cf9\f8\fs20 'AND CAT ='\f0\cf0 \cf10\f9\fs20 +\f0\cf0  \cf5\f4\fs20 quotedstr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 comboBox1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 text\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                   \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                  \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 ComboBox1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ItemIndex\f0\cf0 \cf10\f9\fs20 :=-\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 >\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0  \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'ABSQuery80 errore eof'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par 
\par             \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQuery85\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par               \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'Select * from Classifica  Order By "COGNOME","CODDSPL"'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0              \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //ricostruisce la tabella 15 dopo aver ordinato i dati\f0\cf0\i0 
\par             \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //devo cancellare per poter sostituire\f0\cf0\i0 
\par             \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //con i dati sortati e senza problemi di indice\f0\cf0\i0 
\par             \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Last\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EOF\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //copia il query ordinato nella Tabella 15\f0\cf0\i0 
\par               \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Insert\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMR'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMR'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'COGNOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'COGNOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPET'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPET'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPOS'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPOS'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TAME1'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TAME1'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TBME2'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TBME2'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DQ'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DQ'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'PEN'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'PEN'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'MANL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'MANL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CAT'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CAT'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Post\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par            \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 >\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0  \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'ABSQuery85 errore eof'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par 
\par           \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 MessageDlg\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Desideri esaminare un rapporto dei Dati Base per la Classifica ?'\f0\cf0 
\par            \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mtconfirmation\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 mbYes\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mbNo\f0\cf0 \cf10\f9\fs20 ],\f0\cf0  \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \cf10\f9\fs20 =\f0\cf0  \cf5\f4\fs20 mrYes\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par             \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par               \cf5\f4\fs20 frxReport8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ShowReport\f0\cf0 \cf10\f9\fs20 ;\f0\cf0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //dati da ABSTable15 (Classifica)\f0\cf0\i0 
\par                  \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 MessageDlg\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Confermi i dati a base della classifica? '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 #13\f0\cf0 \cf10\f9\fs20 +\f0\cf0 
\par                   \cf9\f8\fs20 'In caso negativo ESCI e correggi le scelte fatte.'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 
\par                    \cf5\f4\fs20 mtconfirmation\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 mbYes\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mbNo\f0\cf0 \cf10\f9\fs20 ],\f0\cf0  \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \cf10\f9\fs20 =\f0\cf0  \cf5\f4\fs20 mrNO\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par                    \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                      \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                      \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                      \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                    \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par            \cf5\f4\fs20 RadioButton1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clLime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 Calcola\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Self\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par            \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par         \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //GRUPPO A\f0\cf0\i0 
\par       \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 RadioButton2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Checked\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 True\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par           \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 MessageDlg\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Confermi di effettuare la classifica sul Gruppo A ?'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 
\par             \cf5\f4\fs20 mtconfirmation\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 mbYes\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mbNo\f0\cf0 \cf10\f9\fs20 ],\f0\cf0  \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \cf10\f9\fs20 =\f0\cf0  \cf5\f4\fs20 mrNo\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par           \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Cambia il Gruppo'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par           \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0  \b\cf6\f5\fs20 else\f0\cf0\b0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //converte l'array delle gare in string per il Query\f0\cf0\i0 
\par             \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par                \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                  \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Attenzione il Gruppo scelto non contiene discipline !'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                  \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 '('\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \b\cf6\f5\fs20 for\f0\cf0\b0  \cf5\f4\fs20 i\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 to\f0\cf0\b0  \cf5\f4\fs20 MaxIdxGare\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par                \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 ])+\f0\cf0 \cf9\f8\fs20 ','\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 MaxIdxGare\f0\cf0 \cf10\f9\fs20 ]);\f0\cf0 
\par                \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 ')'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par             \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQuery80\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0      \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Estrae dal Base le discipline gruppo A\f0\cf0\i0 
\par               \b\cf6\f5\fs20 begin\f0\cf0\b0                 \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //per tutte le gare indicate e estrae le\f0\cf0\i0 
\par                 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0              \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // coppie di valori n.gara e n.disciplina\f0\cf0\i0 
\par                 \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'Select * from GRPA where CODGA IN '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //dall'ARRAY\f0\cf0\i0 
\par                 \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Fase di raccolta record da classificare in T15 Classifica\f0\cf0\i0 
\par            \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par                \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                  \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Attenzione il Gruppo scelto non contiene discipline !'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                  \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par            \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 >\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0     \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Azzero la tabella Classifica\f0\cf0\i0 
\par             \b\cf6\f5\fs20 begin\f0\cf0\b0                              \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // preesistente per non causare\f0\cf0\i0 
\par               \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0                \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // problemi di indice unique\f0\cf0\i0 
\par               \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Last\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //ABSQuery80 \u232?una tabella con gare e discipline\f0\cf0\i0 
\par            \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EOF\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0             \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // selezionate\f0\cf0\i0 
\par              \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par               \cf5\f4\fs20 Cgara\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \cf5\f4\fs20 Cdspl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQuery85\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0      \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Estrae dalle Gare le discipline da classif\f0\cf0\i0 
\par                  \b\cf6\f5\fs20 begin\f0\cf0\b0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Costruisce Classifica con tutti i record gare e discipline\f0\cf0\i0 
\par                   \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //selezionate e gli Atleti che le hanno in comune\f0\cf0\i0 
\par                   \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'INSERT INTO Classifica SELECT * From Gara where CODGA='\f0\cf0 
\par                   \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Cgara\f0\cf0 \cf10\f9\fs20 ))+\f0\cf0 \cf9\f8\fs20 ' AND CODDSPL='\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Cdspl\f0\cf0 \cf10\f9\fs20 ))\f0\cf0 
\par                   \cf10\f9\fs20 +\f0\cf0  \cf9\f8\fs20 'AND CAT ='\f0\cf0 \cf10\f9\fs20 +\f0\cf0  \cf5\f4\fs20 quotedstr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 comboBox1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 text\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                   \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                  \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 ComboBox1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ItemIndex\f0\cf0 \cf10\f9\fs20 :=-\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 >\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0  \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'ABSQuery80 errore eof'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par 
\par             \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQuery85\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par               \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'Select * from Classifica  Order By "COGNOME","CODDSPL"'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //30/04/15 18:06 devo cancellare per poter sostituire\f0\cf0\i0 
\par             \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //con i dati sortati e senza problemi di indice\f0\cf0\i0 
\par             \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Last\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EOF\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //copia il query ordinato nella Tabella 15\f0\cf0\i0 
\par               \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Insert\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMR'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMR'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'COGNOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'COGNOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPET'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPET'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPOS'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPOS'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TAME1'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TAME1'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TBME2'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TBME2'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DQ'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DQ'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'PEN'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'PEN'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'MANL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'MANL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CAT'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CAT'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Post\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par            \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 >\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0  \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'ABSQuery85 errore eof'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par 
\par           \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 MessageDlg\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Desideri esaminare un rapporto dei Dati Base per la Classifica ?'\f0\cf0 
\par            \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mtconfirmation\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 mbYes\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mbNo\f0\cf0 \cf10\f9\fs20 ],\f0\cf0  \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \cf10\f9\fs20 =\f0\cf0  \cf5\f4\fs20 mrYes\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par             \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par               \cf5\f4\fs20 frxReport8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ShowReport\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                  \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 MessageDlg\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Confermi i dati a base della classifica? '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 #13\f0\cf0 \cf10\f9\fs20 +\f0\cf0 
\par                   \cf9\f8\fs20 'In caso negativo ESCI e correggi le scelte fatte.'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 
\par                    \cf5\f4\fs20 mtconfirmation\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 mbYes\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mbNo\f0\cf0 \cf10\f9\fs20 ],\f0\cf0  \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \cf10\f9\fs20 =\f0\cf0  \cf5\f4\fs20 mrNO\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par                    \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                      \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                      \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                      \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                    \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par            \cf5\f4\fs20 RadioButton2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clLime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 Calcola\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Self\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par            \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par 
\par         \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //GRUPPO B\f0\cf0\i0 
\par      \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 RadioButton3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Checked\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 True\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par         \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 MessageDlg\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Confermi di effettuare la classifica sul Gruppo B ?'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 
\par       \cf5\f4\fs20 mtconfirmation\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 mbYes\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mbNo\f0\cf0 \cf10\f9\fs20 ],\f0\cf0  \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \cf10\f9\fs20 =\f0\cf0  \cf5\f4\fs20 mrNo\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par           \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Cambia il Gruppo'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par           \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0  \b\cf6\f5\fs20 else\f0\cf0\b0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //converte l'array delle gare in string per il Query\f0\cf0\i0 
\par             \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable9\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable9\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par                \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                  \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Attenzione il Gruppo scelto non contiene discipline !'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                  \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 '('\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \b\cf6\f5\fs20 for\f0\cf0\b0  \cf5\f4\fs20 i\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 to\f0\cf0\b0  \cf5\f4\fs20 MaxIdxGare\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par                \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 ])+\f0\cf0 \cf9\f8\fs20 ','\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 MaxIdxGare\f0\cf0 \cf10\f9\fs20 ]);\f0\cf0 
\par                \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 ')'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par             \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQuery80\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0      \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Estrae dal Base le discipline gruppo B\f0\cf0\i0 
\par               \b\cf6\f5\fs20 begin\f0\cf0\b0                 \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //per tutte le gare indicate e estrae le\f0\cf0\i0 
\par                 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0              \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // coppie di valori n.gara e n.disciplina\f0\cf0\i0 
\par                 \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'Select * from GRPB where CODGA IN '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 QryStr\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //dall'ARRAY\f0\cf0\i0 
\par                 \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Fase di raccolta record da classificare in T15 Classifica\f0\cf0\i0 
\par            \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par                \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                  \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Attenzione il Gruppo scelto non contiene discipline !'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                  \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par            \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 >\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0     \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Azzero la tabella Classifica\f0\cf0\i0 
\par             \b\cf6\f5\fs20 begin\f0\cf0\b0                              \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // preesistente per non causare\f0\cf0\i0 
\par               \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0                \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // problemi di indice unique\f0\cf0\i0 
\par               \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Last\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //ABSQuery80 \u232?una tabella con gare e discipline\f0\cf0\i0 
\par            \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EOF\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0             \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // selezionate\f0\cf0\i0 
\par              \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par               \cf5\f4\fs20 Cgara\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \cf5\f4\fs20 Cdspl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQuery85\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0      \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Estrae dalle Gare le discipline da classif\f0\cf0\i0 
\par                  \b\cf6\f5\fs20 begin\f0\cf0\b0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Costruisce Classifica con tutti i record gare e discipline\f0\cf0\i0 
\par                   \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //selezionate e gli Atleti che le hanno in comune\f0\cf0\i0 
\par                   \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'INSERT INTO Classifica SELECT * From Gara where CODGA='\f0\cf0 
\par                   \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Cgara\f0\cf0 \cf10\f9\fs20 ))+\f0\cf0 \cf9\f8\fs20 ' AND CODDSPL='\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Cdspl\f0\cf0 \cf10\f9\fs20 ))\f0\cf0 
\par                   \cf10\f9\fs20 +\f0\cf0  \cf9\f8\fs20 'AND CAT ='\f0\cf0 \cf10\f9\fs20 +\f0\cf0  \cf5\f4\fs20 quotedstr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 comboBox1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 text\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                   \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                  \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 ComboBox1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ItemIndex\f0\cf0 \cf10\f9\fs20 :=-\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 >\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0  \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'ABSQuery80 errore eof'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par 
\par             \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQuery85\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0     \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //per ordinare per cognome la classifica\f0\cf0\i0 
\par               \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'Select * from Classifica  Order By "COGNOME","CODDSPL"'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //30/04/15 18:06 devo cancellare per poter sostituire\f0\cf0\i0 
\par             \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //con i dati sortati e senza problemi di indice\f0\cf0\i0 
\par             \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Last\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EOF\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //copia il query ordinato per cogn/discipl nella Tabella 15\f0\cf0\i0 
\par               \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Insert\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMR'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMR'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'COGNOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'COGNOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPET'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPET'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPOS'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPOS'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TAME1'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TAME1'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TBME2'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TBME2'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DQ'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DQ'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'PEN'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'PEN'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'MANL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'MANL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CAT'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CAT'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Post\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par            \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 >\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0  \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'ABSQuery85 errore eof'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par 
\par           \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 MessageDlg\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Desideri esaminare un rapporto dei Dati Base per la Classifica ?'\f0\cf0 
\par            \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mtconfirmation\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 mbYes\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mbNo\f0\cf0 \cf10\f9\fs20 ],\f0\cf0  \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \cf10\f9\fs20 =\f0\cf0  \cf5\f4\fs20 mrYes\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par             \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par               \cf5\f4\fs20 frxReport8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ShowReport\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                  \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 MessageDlg\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Confermi i dati a base della classifica? '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 #13\f0\cf0 \cf10\f9\fs20 +\f0\cf0 
\par                   \cf9\f8\fs20 'In caso negativo ESCI e correggi le scelte fatte.'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 
\par                    \cf5\f4\fs20 mtconfirmation\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 mbYes\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mbNo\f0\cf0 \cf10\f9\fs20 ],\f0\cf0  \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \cf10\f9\fs20 =\f0\cf0  \cf5\f4\fs20 mrNO\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par                    \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                      \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                      \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                      \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                    \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par            \cf5\f4\fs20 RadioButton3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clLime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 Calcola\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Self\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par            \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par \b\cf6\f5\fs20 procedure\f0\cf0\b0  \cf5\f4\fs20 TForm8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Button7Click\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Sender\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TObject\f0\cf0 \cf10\f9\fs20 );\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Classifica per discipline\f0\cf0\i0 
\par  \b\cf6\f5\fs20 var\f0\cf0\b0 
\par  \cf5\f4\fs20 dsplsi\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 garesi\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 trovato\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \cf5\f4\fs20 Boolean\f0\cf0 \cf10\f9\fs20 ;\f0\cf0          \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Individua prima le Gare\f0\cf0\i0 
\par  \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 qtrl2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 cgara\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 cdspl\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \cf5\f4\fs20 Integer\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par     \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable5\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable4\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 ClassDp\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 True\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 cgara\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 cdspl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //resetta la tabella gare selezionate\f0\cf0\i0 
\par     \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0         \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // e carica la Tabella con le Gare scelte per\f0\cf0\i0 
\par     \b\cf6\f5\fs20 for\f0\cf0\b0  \cf5\f4\fs20 i\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 to\f0\cf0\b0  \cf5\f4\fs20 High\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //la ricerca per discipline\f0\cf0\i0 
\par       \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 ]=\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par           \cf5\f4\fs20 mom\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //mom = all'ultimo elemento dell'array memorizzato\f0\cf0\i0 
\par           \cf5\f4\fs20 Break\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par       \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 mom\f0\cf0 \cf10\f9\fs20 =-\f0\cf0 \cf7\f6\fs20 1\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par           \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Non vi sono elementi memorizzati ! - ripeti'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par           \cf5\f4\fs20 Shape2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Brush\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par     \b\cf6\f5\fs20 for\f0\cf0\b0  \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 to\f0\cf0\b0  \cf5\f4\fs20 mom\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0      \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //crea la tabella 3\f0\cf0\i0 
\par       \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par        \cf5\f4\fs20 idx\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 ];\f0\cf0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Trasferisce i dati dall'Array alla Tabella\f0\cf0\i0 
\par        \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Insert\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Codice'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 idx\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 garesi\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable5\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Locate\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 idx\f0\cf0 \cf10\f9\fs20 ,[]);\f0\cf0 
\par        \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Descrizione'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                    \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable5\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'LUOGO'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Post\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par 
\par     \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //resetta la tabella discipline selezionate\f0\cf0\i0 
\par     \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \b\cf6\f5\fs20 for\f0\cf0\b0  \cf5\f4\fs20 i\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 to\f0\cf0\b0  \cf5\f4\fs20 High\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArDspl\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par       \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ArDspl\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 ]=\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par           \cf5\f4\fs20 momd\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //momd = all'ultimo elemento dell'array memorizzato\f0\cf0\i0 
\par           \cf5\f4\fs20 Break\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par       \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 momd\f0\cf0 \cf10\f9\fs20 =-\f0\cf0 \cf7\f6\fs20 1\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par           \cf5\f4\fs20 DBGrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 DataSource\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 DataSet\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Non vi sono discipline memorizzate ! - Selezionale'\f0\cf0 
\par           \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 #13#10\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 ' In alternativa Esci '\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par           \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par     \b\cf6\f5\fs20 for\f0\cf0\b0  \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 to\f0\cf0\b0  \cf5\f4\fs20 momd\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0      \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //crea la tabella 3D\f0\cf0\i0 
\par       \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par        \cf5\f4\fs20 idx\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ArDspl\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 ];\f0\cf0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Trasferisce i dati dall'Array alla Tabella 3D\f0\cf0\i0 
\par        \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Insert\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 idx\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 dsplsi\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable4\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Locate\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 idx\f0\cf0 \cf10\f9\fs20 ,[]);\f0\cf0 
\par        \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DESCR'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                    \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable4\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DESCR'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMAX'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                    \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable4\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMAX'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Post\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0                             \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //mi sembra una conferma inutile\f0\cf0\i0 
\par                 \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Datasource8 \u232?ora associato alle discipline scelte\f0\cf0\i0 
\par   \i\cf2\f1\fs20 \{   DataSource8.DataSet:=Form2.ABSTable3D;        //display gare su dbgrid\f0\cf0\i0 
\par \i\cf2\f1\fs20      DBGrid8.DataSource:=DataSource8;\f0\cf0\i0 
\par \i\cf2\f1\fs20      DBGrid8.Width:=376;\f0\cf0\i0 
\par \i\cf2\f1\fs20      DBGrid8.Columns[0].Width:=44;\f0\cf0\i0 
\par \i\cf2\f1\fs20      DBGrid8.Columns[1].Width:=291;\f0\cf0\i0 
\par \i\cf2\f1\fs20      if MessageDlg('Confermi di effettuare la classifica su questi elementi ?',\f0\cf0\i0 
\par \i\cf2\f1\fs20       mtconfirmation, [mbYes,mbNo], 0) = mrNo then\f0\cf0\i0 
\par \i\cf2\f1\fs20       begin\f0\cf0\i0 
\par \i\cf2\f1\fs20         Form2.ABSTable3D.Close;\f0\cf0\i0 
\par \i\cf2\f1\fs20         Form2.ABSTable3D.EmptyTable;\f0\cf0\i0 
\par \i\cf2\f1\fs20         Shape1.Brush.Color := clRed;\f0\cf0\i0 
\par \i\cf2\f1\fs20         SetLength(ArDspl,0); //azzera l'array delle Discipline non confermando la scelta\f0\cf0\i0 
\par \i\cf2\f1\fs20         SetLength(ArDspl,20);\f0\cf0\i0 
\par \i\cf2\f1\fs20         Exit;\f0\cf0\i0 
\par \i\cf2\f1\fs20       end;  \}\f0\cf0\i0 
\par        \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 comboBox1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ItemIndex\f0\cf0 \cf10\f9\fs20 =-\f0\cf0 \cf7\f6\fs20 1\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par            \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Devi scegliere una Categoria'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par            \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0  \b\cf6\f5\fs20 else\f0\cf0\b0 
\par      \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par        \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 MessageDlg\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Confermi di effettuare la classifica per la Categoria '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 comboBox1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 '  ?'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 
\par          \cf5\f4\fs20 mtconfirmation\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 mbYes\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mbNo\f0\cf0 \cf10\f9\fs20 ],\f0\cf0  \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \cf10\f9\fs20 =\f0\cf0  \cf5\f4\fs20 mrNo\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par           \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par            \cf5\f4\fs20 Shape3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Brush\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 Exit\f0\cf0  \cf10\f9\fs20 ;\f0\cf0 
\par            \b\cf6\f5\fs20 end\f0\cf0\b0  \cf10\f9\fs20 ;\f0\cf0 
\par      \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0               \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //inizia a raccogliere i record da classificare                                                              //lavori in corso\f0\cf0\i0 
\par       \cf5\f4\fs20 Shape3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Brush\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clLime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 >\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0     \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Azzero la tabella Classifica\f0\cf0\i0 
\par             \b\cf6\f5\fs20 begin\f0\cf0\b0                              \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // preesistente per non causare\f0\cf0\i0 
\par               \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0                \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // problemi di indice unique\f0\cf0\i0 
\par               \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Last\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0        \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Form2.ABSTable3 \u232?una tabella con gare\f0\cf0\i0 
\par            \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par   \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EOF\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0     \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //per ogni gara selezionata\f0\cf0\i0 
\par     \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par       \cf5\f4\fs20 Cgara\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Codice'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \cf5\f4\fs20 qtrl2\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EOF\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //per ogni disciplina selezionata\f0\cf0\i0 
\par           \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par             \cf5\f4\fs20 Cdspl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQuery85\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0      \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Estrae dalle Gare le discipline da classif\f0\cf0\i0 
\par                  \b\cf6\f5\fs20 begin\f0\cf0\b0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Costruisce Classifica con tutti i record gare e discipline\f0\cf0\i0 
\par                   \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //selezionate e gli Atleti che le hanno in comune\f0\cf0\i0 
\par                   \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'INSERT INTO Classifica SELECT * From Gara where CODGA='\f0\cf0 
\par                   \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Cgara\f0\cf0 \cf10\f9\fs20 ))+\f0\cf0 \cf9\f8\fs20 ' AND CODDSPL='\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Cdspl\f0\cf0 \cf10\f9\fs20 ))\f0\cf0 
\par                   \cf10\f9\fs20 +\f0\cf0  \cf9\f8\fs20 'AND CAT ='\f0\cf0 \cf10\f9\fs20 +\f0\cf0  \cf5\f4\fs20 quotedstr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 comboBox1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 text\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                   \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                  \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par            \cf5\f4\fs20 qtrl2\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 qtrl2\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 
\par           \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par       \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 qtrl2\f0\cf0 \cf10\f9\fs20 >\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0  \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Elenco discipline errore eof'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par       \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par       \cf5\f4\fs20 ComboBox1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ItemIndex\f0\cf0 \cf10\f9\fs20 :=-\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 >\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0  \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Elenco gare errore eof'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par 
\par      \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQuery85\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par               \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'Select * from Classifica  Order By "COGNOME","CODDSPL"'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //30/04/15 18:06 devo cancellare per poter sostituire\f0\cf0\i0 
\par             \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //con i dati sortati e senza problemi di indice\f0\cf0\i0 
\par             \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Last\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EOF\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //copia il query ordinato nella Tabella 15\f0\cf0\i0 
\par               \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Insert\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMR'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMR'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'COGNOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'COGNOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPET'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPET'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPOS'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPOS'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TAME1'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TAME1'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TBME2'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TBME2'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DQ'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DQ'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'PEN'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'PEN'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'MANL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'MANL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CAT'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                               \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CAT'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Post\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par            \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 >\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0  \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'ABSQuery85 errore eof'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par 
\par           \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 MessageDlg\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Desideri esaminare un rapporto dei Dati Base per la Classifica ?'\f0\cf0 
\par            \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mtconfirmation\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 mbYes\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mbNo\f0\cf0 \cf10\f9\fs20 ],\f0\cf0  \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \cf10\f9\fs20 =\f0\cf0  \cf5\f4\fs20 mrYes\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par             \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par               \cf5\f4\fs20 frxReport8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ShowReport\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                  \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 MessageDlg\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Confermi i dati a base della classifica? '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 #13\f0\cf0 \cf10\f9\fs20 +\f0\cf0 
\par                   \cf9\f8\fs20 'In caso negativo ESCI e correggi le scelte fatte.'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 
\par                    \cf5\f4\fs20 mtconfirmation\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 mbYes\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mbNo\f0\cf0 \cf10\f9\fs20 ],\f0\cf0  \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \cf10\f9\fs20 =\f0\cf0  \cf5\f4\fs20 mrNO\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par                    \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                      \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                      \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                      \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                    \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par         \cf5\f4\fs20 Calcola\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Self\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par            \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par \b\cf6\f5\fs20 procedure\f0\cf0\b0  \cf5\f4\fs20 TForm8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Calcola\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Sender\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TObject\f0\cf0 \cf10\f9\fs20 );\f0\cf0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // C A L C O L A\f0\cf0\i0 
\par \b\cf6\f5\fs20 var\f0\cf0\b0                                           \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //in questa fase i dati di base\f0\cf0\i0 
\par \cf5\f4\fs20 t1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 t2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 p1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 tmx\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 tmcn\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 d1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 d2\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \cf5\f4\fs20 TDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0                  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //confermati e sono su T15\f0\cf0\i0 
\par \cf5\f4\fs20 h1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 m1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 s1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 z1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 h2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 m2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 s2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 z2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 h3\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 m3\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 s3\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 z3\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \cf5\f4\fs20 Word\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par \cf5\f4\fs20 sql\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 esclusioni\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 trovato\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 ATLsi\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 DQSi\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \cf5\f4\fs20 Boolean\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par \cf5\f4\fs20 esclusi\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \cf5\f4\fs20 TStringList\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par \cf5\f4\fs20 squalificati\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \cf5\f4\fs20 TStringList\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par \cf5\f4\fs20 ca\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 dp\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 ct\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 i\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 imax\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 temp2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 tt\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 tt2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 t1n\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 t2n\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \cf5\f4\fs20 Integer\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par \i\cf2\f1\fs20 \{dacancA:array of smallInt;\f0\cf0\i0 
\par \i\cf2\f1\fs20 dacancD:array of smallInt;\f0\cf0\i0 
\par \i\cf2\f1\fs20 dacancG:array of smallInt; \}\f0\cf0\i0 
\par \cf5\f4\fs20 cgn\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 dscrz\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 durata\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \b\cf6\f5\fs20 string\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par \cf5\f4\fs20 RnkMax\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 rn\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 CODATL16\f0\cf0 \cf10\f9\fs20 :\f0\cf0 \cf5\f4\fs20 Integer\f0\cf0 \cf10\f9\fs20 ;\f0\cf0              \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Fase segnalazione atleti in difetto\f0\cf0\i0 
\par \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par  \cf5\f4\fs20 formatDateTime\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 tmx\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par  \cf5\f4\fs20 formatDateTime\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 tmcn\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par  \cf5\f4\fs20 formatDateTime\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 t1\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par  \cf5\f4\fs20 formatDateTime\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 t2\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par  \cf5\f4\fs20 formatDateTime\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 p1\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par  \cf5\f4\fs20 trovato\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 False\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par  \cf5\f4\fs20 DQSi\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 False\f0\cf0 \cf10\f9\fs20 ;\f0\cf0     \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //serve per assegnare il punteggio 0\f0\cf0\i0 
\par \i\cf2\f1\fs20 \{ SetLength(dacancA,0); //resetta l'array che conterr\u224?i codici atleti\f0\cf0\i0 
\par \i\cf2\f1\fs20  SetLength(dacancA,300);\f0\cf0\i0 
\par \i\cf2\f1\fs20  SetLength(dacancD,0);  //resetta l'array che conterr\u224?i codici discipline\f0\cf0\i0 
\par \i\cf2\f1\fs20  SetLength(dacancD,300);\f0\cf0\i0 
\par \i\cf2\f1\fs20  SetLength(dacancG,0); //resetta l'array che conterr\u224?i codici gare\f0\cf0\i0 
\par \i\cf2\f1\fs20  SetLength(dacancG,300); \}\f0\cf0\i0 
\par  \cf5\f4\fs20 esclusi\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 TStringList\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Create\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 \i\cf2\f1\fs20 //NOTA BENE L'ESCLUSIONE VALE SOLO NEL RUN IN CORSO\f0\cf0\i0 
\par  \cf5\f4\fs20 squalificati\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 TStringList\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Create\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par  \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par  \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //resetta la tabella che conterr\u224?i dati classificati con il rank\f0\cf0\i0 
\par  \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //tabella dati da classificare\f0\cf0\i0 
\par  \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Edit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par  \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Last\f0\cf0 \cf10\f9\fs20 ;\f0\cf0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //per ottenere un conteggio corretto ???!!!\f0\cf0\i0 
\par  \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par  \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //conta i dati in classifiche\f0\cf0\i0 
\par  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //i:=1;\f0\cf0\i0 
\par  \cf5\f4\fs20 esclusioni\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 False\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par      \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //analizza i dati di classifica raccolti in T15 ed evidenzia i problemi\f0\cf0\i0 
\par    \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Eof\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //memorizzazione e correzione\f0\cf0\i0 
\par      \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par        \cf5\f4\fs20 t1\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 TimeOf\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TAME1'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par        \cf5\f4\fs20 t2\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 TimeOf\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TBME2'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par          \cf5\f4\fs20 DecodeTime\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 t1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 h1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 m1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 s1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 z1\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                  \cf5\f4\fs20 t1n\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 h1\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 m1\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 s1\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 z1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par          \cf5\f4\fs20 DecodeTime\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 t2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 h2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 m2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 s2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 z2\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                  \cf5\f4\fs20 t2n\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 h2\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 m2\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 s2\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 z2\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 sql\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DQ'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 ct\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CAT'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 ca\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //memorizza i record\f0\cf0\i0 
\par        \cf5\f4\fs20 cgn\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'COGNOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 dp\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ct\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //manca la categoria e quindi fa uscire dalla procedura\f0\cf0\i0 
\par          \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par            \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Attenzione l'\f0\cf0 \cf9\f8\fs20 'Atleta '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 cgn\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 ' codice '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ca\f0\cf0 \cf10\f9\fs20 )+\f0\cf0 \cf9\f8\fs20 ' gara '\f0\cf0 
\par            \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 )+\f0\cf0 \cf9\f8\fs20 ' disciplina '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 dp\f0\cf0 \cf10\f9\fs20 )+\f0\cf0 \cf9\f8\fs20 #13\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 #13\f0\cf0 \cf10\f9\fs20 +\f0\cf0 
\par            \cf9\f8\fs20 ' non ha la categoria. Correggi'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par            \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par          \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par        \b\cf6\f5\fs20 if\f0\cf0\b0  \cf10\f9\fs20 ((\f0\cf0 \cf5\f4\fs20 t1n\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \b\cf6\f5\fs20 and\f0\cf0\b0  \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 t2n\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 ))\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Individue mancanza di tempi o squalifica\f0\cf0\i0 
\par          \b\cf6\f5\fs20 begin\f0\cf0\b0         \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //salva nella lista esclusi e poi in un file txt\f0\cf0\i0 
\par            \cf5\f4\fs20 esclusi\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Add\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Gara '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 Inttostr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 )+\f0\cf0 \cf9\f8\fs20 ' codice: '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 intToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ca\f0\cf0 \cf10\f9\fs20 )+\f0\cf0 \cf9\f8\fs20 '  '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 cgn\f0\cf0 \cf10\f9\fs20 +\f0\cf0 
\par            \cf9\f8\fs20 ' Disc. '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 intTostr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 dp\f0\cf0 \cf10\f9\fs20 ));\f0\cf0 
\par           \i\cf2\f1\fs20 \{ dacancA[i]:=ca;   //memorizza i dati da-completare;\f0\cf0\i0 
\par \i\cf2\f1\fs20            dacancD[i]:=dp;   //Questi array non vengono utilizzati\f0\cf0\i0 
\par \i\cf2\f1\fs20            dacancG[i]:=ga;\f0\cf0\i0 
\par \i\cf2\f1\fs20            i:=i+1; \}\f0\cf0\i0 
\par            \cf5\f4\fs20 esclusioni\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 True\f0\cf0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //alza un flag per esistenza mancanza dati\f0\cf0\i0 
\par          \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par         \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 sql\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 True\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Individue una squalifica\f0\cf0\i0 
\par                  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //salva nella lista squalificati e poi in un file txt\f0\cf0\i0 
\par            \cf5\f4\fs20 squalificati\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Add\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Gara '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 Inttostr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 )+\f0\cf0 \cf9\f8\fs20 ' codice: '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 intToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ca\f0\cf0 \cf10\f9\fs20 )+\f0\cf0 \cf9\f8\fs20 '  '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 cgn\f0\cf0 \cf10\f9\fs20 +\f0\cf0 
\par            \cf9\f8\fs20 ' Disc. '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 intTostr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 dp\f0\cf0 \cf10\f9\fs20 ));\f0\cf0 
\par        \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //imax:=i;\f0\cf0\i0 
\par 
\par        \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par      \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par   \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 >\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0  \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'ABSTable15 errore eof'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par 
\par    \b\cf6\f5\fs20 if\f0\cf0\b0  \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 esclusi\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Count\f0\cf0 \cf10\f9\fs20 <\f0\cf0 \cf7\f6\fs20 50\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \b\cf6\f5\fs20 and\f0\cf0\b0  \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 esclusi\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Count\f0\cf0 \cf10\f9\fs20 >\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par         \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 ' Atleti con dati mancanti'\f0\cf0  \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 #13\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 #13\f0\cf0 \cf10\f9\fs20 +\f0\cf0  \cf5\f4\fs20 esclusi\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 #13\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 #13\f0\cf0 \cf10\f9\fs20 +\f0\cf0 
\par          \cf9\f8\fs20 ' Dati salvati su Mancanti.txt'\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \b\cf6\f5\fs20 else\f0\cf0\b0 
\par       \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par          \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 esclusi\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 count\f0\cf0 \cf10\f9\fs20 >\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par          \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Lista Atleti con dati mancanti, salvata in "Mancanti.txt".'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par       \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par     \cf5\f4\fs20 esclusi\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 SaveToFile\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 '.\\Mancanti.txt'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par     \cf5\f4\fs20 esclusi\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Clear\f0\cf0 \cf10\f9\fs20 ;\f0\cf0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //resetta la lista esclusi\f0\cf0\i0 
\par    \b\cf6\f5\fs20 if\f0\cf0\b0  \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 squalificati\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Count\f0\cf0 \cf10\f9\fs20 <\f0\cf0 \cf7\f6\fs20 50\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \b\cf6\f5\fs20 and\f0\cf0\b0  \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 squalificati\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Count\f0\cf0 \cf10\f9\fs20 >\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par         \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 ' Atleti con squalifica'\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 #13#10\f0\cf0 \cf10\f9\fs20 +\f0\cf0  \cf5\f4\fs20 squalificati\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 text\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par      \cf5\f4\fs20 squalificati\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Clear\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Calcolo dei tempi  usa SelezioneGare T3 e classifiche T15\f0\cf0\i0 
\par     \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //\u232?la tabella dove finiscono le gare selezionate\f0\cf0\i0 
\par     \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 eof\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Qu\u236?inizia il giro delle gare scelte\f0\cf0\i0 
\par      \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par       \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Codice'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 ABSTable18\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0        \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //azzera la T18 (discipline della gara)\f0\cf0\i0 
\par        \cf5\f4\fs20 ABSTable18\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // per ricevere i dati della nuova gara\f0\cf0\i0 
\par        \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // DataSourceQry.DataSet:=ABSQuery85;\f0\cf0\i0 
\par          \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQuery85\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //seleziona tutte le discipline della gara scelta\f0\cf0\i0 
\par            \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par             \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0     \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //qu\u236?nasce la ABSTable18 con tutte le discipline di una gara\f0\cf0\i0 
\par             \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'INSERT INTO Temp8 Select * from Classifica where CODGA = '\f0\cf0 
\par             \cf10\f9\fs20 +\f0\cf0  \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 ))+\f0\cf0 \cf9\f8\fs20 ' Order By "CODDSPL"'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Open;\f0\cf0\i0 
\par            \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //creata la Temp8 = le discipline della gara indipendentemente dal Gruppo\f0\cf0\i0 
\par                           \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Crea le discipline da classificare per la gara scelta\f0\cf0\i0 
\par 
\par      \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ClassDp\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 False\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //se non effettua una classifica per discipline\f0\cf0\i0 
\par        \b\cf6\f5\fs20 Begin\f0\cf0\b0                 \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // cio\u232?sta facendo una classifica per Gare\f0\cf0\i0 
\par           \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQuery80\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par            \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par             \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0           \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //determina il Gruppo scelto\f0\cf0\i0 
\par             \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 RadioButton1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Checked\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 True\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par                \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf9\f8\fs20 'Select CODDSPL from Base where CODGA = '\f0\cf0 
\par                 \cf10\f9\fs20 +\f0\cf0  \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 ))+\f0\cf0 \cf9\f8\fs20 ' Order By "CODDSPL"'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 RadioButton2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Checked\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 True\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par                \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf9\f8\fs20 'Select CODDSPL from GRPA where CODGA = '\f0\cf0 
\par                 \cf10\f9\fs20 +\f0\cf0  \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 ))+\f0\cf0 \cf9\f8\fs20 ' Order By "CODDSPL"'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 RadioButton3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Checked\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 True\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par                \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf9\f8\fs20 'Select CODDSPL from GRPB where CODGA = '\f0\cf0 
\par                \cf10\f9\fs20 +\f0\cf0  \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 ))+\f0\cf0 \cf9\f8\fs20 ' Order By "CODDSPL"'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par        \b\cf6\f5\fs20 end\f0\cf0\b0  \b\cf6\f5\fs20 else\f0\cf0\b0 
\par        \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par           \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQuery80\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Contiene le discipline del Gruppo scelto\f0\cf0\i0 
\par            \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par              \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //seleziona i valori diversi = distinct\f0\cf0\i0 
\par              \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf9\f8\fs20 'Select distinct CODDSPL from Classifica where CODGA = '\f0\cf0 
\par              \cf10\f9\fs20 +\f0\cf0  \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 ))+\f0\cf0 \cf9\f8\fs20 ' Order By "CODDSPL"'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par         \cf5\f4\fs20 ABSTable18\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //contiene le discipline della gara ed i dati relativi\f0\cf0\i0 
\par         \cf5\f4\fs20 TDateTimeField\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Form8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable18\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TAME1'\f0\cf0 \cf10\f9\fs20 )).\f0\cf0 \cf5\f4\fs20 DisplayFormat\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \cf5\f4\fs20 TDateTimeField\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Form8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable18\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TBME2'\f0\cf0 \cf10\f9\fs20 )).\f0\cf0 \cf5\f4\fs20 DisplayFormat\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \cf5\f4\fs20 TDateTimeField\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Form8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable18\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'PEN'\f0\cf0 \cf10\f9\fs20 )).\f0\cf0 \cf5\f4\fs20 DisplayFormat\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par          \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //  T18 tutte le dspl di una gara\f0\cf0\i0 
\par 
\par         \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //  Tutte le dspl del gruppo scelto\f0\cf0\i0 
\par        \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 eof\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par        \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par            \cf5\f4\fs20 dp\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQuery83\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0                            \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Tutte le discipline\f0\cf0\i0 
\par             \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par               \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //la ABSTable18 fornisce i dati per la disciplina\f0\cf0\i0 
\par               \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'Select * from Temp8 where CODDSPL = '\f0\cf0 \cf10\f9\fs20 +\f0\cf0  \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 dp\f0\cf0 \cf10\f9\fs20 ))+\f0\cf0 
\par                \cf9\f8\fs20 ' Order By "CODATL"'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Creata Query83 = i record di una disciplina per volta\f0\cf0\i0 
\par              \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //qu\u236?ci sono tutti i record relativi ad una gara su una disciplina\f0\cf0\i0 
\par              \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //con i tempi di ciascun Atleta e si pu\u242?valutare il vincitore\f0\cf0\i0 
\par             \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //ATTENZIONE PUO' CAPITARE CHE NESSUN ATLETA \u232?ISCRITTO\f0\cf0\i0 
\par             \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ABSQuery83\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par               \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                 \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Attenzione nessun atleta iscritto alla disciplina '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 dp\f0\cf0 \cf10\f9\fs20 )+\f0\cf0 \cf9\f8\fs20 #13\f0\cf0 \cf10\f9\fs20 +\f0\cf0 
\par                 \cf9\f8\fs20 'nella Gara : '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 inttostr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 ));\f0\cf0 
\par                 \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 Continue\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par             \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //ripulisce la T16 che conterr\u224?i dati di ranking\f0\cf0\i0 
\par             \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0         \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //definisce i formati dei tempi\f0\cf0\i0 
\par               \cf5\f4\fs20 TDateTimeField\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Form8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TAME1'\f0\cf0 \cf10\f9\fs20 )).\f0\cf0 
\par                                               \cf5\f4\fs20 DisplayFormat\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \cf5\f4\fs20 TDateTimeField\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Form8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TBME2'\f0\cf0 \cf10\f9\fs20 )).\f0\cf0 
\par                                               \cf5\f4\fs20 DisplayFormat\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \cf5\f4\fs20 TDateTimeField\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Form8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'PEN'\f0\cf0 \cf10\f9\fs20 )).\f0\cf0 
\par                                               \cf5\f4\fs20 DisplayFormat\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \cf5\f4\fs20 TDateTimeField\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Form8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 )).\f0\cf0 
\par                                               \cf5\f4\fs20 DisplayFormat\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSQuery83\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Last\f0\cf0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //CREA LA T16 DOVE SI ASSEGNANO I TEMPI e i DQ\f0\cf0\i0 
\par             \cf5\f4\fs20 ABSQuery83\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0              \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //ricorda che Q83 contiene i dati una disciplina per volta\f0\cf0\i0 
\par             \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQuery83\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 ABSQuery83\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EOF\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //query ordinato nella Tabella 16 Una Gara\f0\cf0\i0 
\par               \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Insert\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMR'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery83\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMR'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0        \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //  Una disciplna\f0\cf0\i0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery83\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery83\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery83\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'COGNOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery83\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'COGNOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPET'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery83\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPET'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPOS'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery83\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPOS'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TAME1'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery83\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TAME1'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TBME2'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery83\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TBME2'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DQ'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery83\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DQ'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'PEN'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery83\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'PEN'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'MANL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery83\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'MANL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CAT'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery83\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CAT'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Post\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSQuery83\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par            \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 >\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0  \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'ABSQuery83_2 errore eof'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par             \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // a questo punto la T16 contiene i dati di una disciplina\f0\cf0\i0 
\par 
\par              \cf5\f4\fs20 RnkMax\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //il valore del ranking parte dal numero di partecipanti\f0\cf0\i0 
\par              \cf5\f4\fs20 rn\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 RnkMax\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par               \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                                \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //ricava TMAX  e il cod. disciplina dalla T4\f0\cf0\i0 
\par                 \cf5\f4\fs20 dp\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                  \cf5\f4\fs20 trovato\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable4\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Locate\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 dp\f0\cf0 \cf10\f9\fs20 ,[]);\f0\cf0 
\par            \cf5\f4\fs20 TDateTimeField\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable4\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMAX'\f0\cf0 \cf10\f9\fs20 )).\f0\cf0 
\par                                               \cf5\f4\fs20 DisplayFormat\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 trovato\f0\cf0  \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 True\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0  \cf5\f4\fs20 tmx\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable4\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMAX'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 
\par                 \b\cf6\f5\fs20 else\f0\cf0\b0 
\par                   \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                    \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'ERRORE, Disciplina o TMAX non trovato per la disciplina : '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 inttostr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 dp\f0\cf0 \cf10\f9\fs20 ));\f0\cf0 
\par                    \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                   \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par               \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 eof\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //un record per volta colleziona i dati di un atleta\f0\cf0\i0 
\par                \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Edit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 t1\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TAME1'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 t2\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TBME2'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                    \cf5\f4\fs20 DecodeTime\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 t1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 h1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 m1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 s1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 z1\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                       \cf5\f4\fs20 t1n\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 h1\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 m1\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 s1\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 z1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                    \cf5\f4\fs20 DecodeTime\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 t2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 h2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 m2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 s2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 z2\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                       \cf5\f4\fs20 t2n\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 h2\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 m2\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 s2\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 z2\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 p1\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'PEN'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 sql\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DQ'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ca\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // controlla propriet\u224?dei tempi\f0\cf0\i0 
\par                 \cf5\f4\fs20 DecodeTime\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 t1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 h1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 m1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 s1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 z1\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                 \cf5\f4\fs20 DecodeTime\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 t2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 h2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 m2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 s2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 z2\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                 \b\cf6\f5\fs20 if\f0\cf0\b0  \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 h1\f0\cf0 \cf10\f9\fs20 <>\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \b\cf6\f5\fs20 or\f0\cf0\b0  \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 h2\f0\cf0 \cf10\f9\fs20 <>\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //se ci sono ore inserite\f0\cf0\i0 
\par                   \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                     \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Impossibile classificare: presenti valori'\f0\cf0 \cf10\f9\fs20 +\f0\cf0 
\par                     \cf9\f8\fs20 ' incompatibili per l'\f0\cf0 \cf9\f8\fs20 'Atleta : '\f0\cf0 \cf10\f9\fs20 +\f0\cf0  \cf5\f4\fs20 inttostr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ca\f0\cf0 \cf10\f9\fs20 ));\f0\cf0 
\par                     \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                   \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par                                    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //tempo medio  aggiungendo, se c'\u232? la penalit\u224?\f0\cf0\i0 
\par                 \b\cf6\f5\fs20 if\f0\cf0\b0  \cf10\f9\fs20 ((\f0\cf0 \cf5\f4\fs20 t1n\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0 \b\cf6\f5\fs20 and\f0\cf0\b0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 t2n\f0\cf0 \cf10\f9\fs20 <>\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 ))\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par                   \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                    \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 t2\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 p1\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                    \cf5\f4\fs20 TDateTimeField\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Form8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 )).\f0\cf0 \cf5\f4\fs20 DisplayFormat\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                   \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par                 \b\cf6\f5\fs20 if\f0\cf0\b0  \cf10\f9\fs20 ((\f0\cf0 \cf5\f4\fs20 t1n\f0\cf0 \cf10\f9\fs20 <>\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0 \b\cf6\f5\fs20 and\f0\cf0\b0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 t2n\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 ))\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par                   \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                      \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 t1\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 p1\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                      \cf5\f4\fs20 TDateTimeField\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Form8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 )).\f0\cf0 \cf5\f4\fs20 DisplayFormat\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                   \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par                      \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // inserisce il valore medio calcolato\f0\cf0\i0 
\par                 \b\cf6\f5\fs20 if\f0\cf0\b0  \cf10\f9\fs20 ((\f0\cf0 \cf5\f4\fs20 t1n\f0\cf0 \cf10\f9\fs20 <>\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0 \b\cf6\f5\fs20 and\f0\cf0\b0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 t2n\f0\cf0 \cf10\f9\fs20 <>\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 ))\f0\cf0 \b\cf6\f5\fs20 then\f0\cf0\b0 
\par                   \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                     \cf5\f4\fs20 tmcn\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf10\f9\fs20 (((\f0\cf0 \cf5\f4\fs20 t1\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 t2\f0\cf0 \cf10\f9\fs20 )/\f0\cf0 \cf7\f6\fs20 2\f0\cf0 \cf10\f9\fs20 )+\f0\cf0 \cf5\f4\fs20 p1\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                     \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 tmcn\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                     \cf5\f4\fs20 TDateTimeField\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Form8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 )).\f0\cf0 \cf5\f4\fs20 DisplayFormat\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                   \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Post\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //nuovo atleta\f0\cf0\i0 
\par                \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par               \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //A questo punto la T16 ha i dati medi per l'Assegnazione Del Ranking\f0\cf0\i0 
\par                \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQuery85\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par             \b\cf6\f5\fs20 begin\f0\cf0\b0                 \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Ordina per tempi crescenti\f0\cf0\i0 
\par               \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'Select * from Ranking Order By "TMC"'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \cf5\f4\fs20 Open\f0\cf0 
\par             \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par             \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Attenzione cancella la T16\f0\cf0\i0 
\par             \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Edit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Last\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EOF\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0      \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //AGGIORNA la T16 RANKING\f0\cf0\i0 
\par               \b\cf6\f5\fs20 begin\f0\cf0\b0                               \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Ordinata per tempi crescenti\f0\cf0\i0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Insert\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMR'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMR'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'COGNOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'COGNOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPET'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPET'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPOS'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPOS'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TAME1'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TAME1'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TBME2'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TBME2'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DQ'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DQ'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'PEN'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'PEN'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'MANL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'MANL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CAT'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CAT'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Post\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0        \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Essendo ordinata per Tempi decrescenti\f0\cf0\i0 
\par             \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 eof\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //scorre tutti i record per DQ da TMAX\f0\cf0\i0 
\par                \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                  \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Edit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                  \cf5\f4\fs20 tmcn\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                  \cf5\f4\fs20 ca\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0  \cf10\f9\fs20 ;\f0\cf0 
\par                  \cf5\f4\fs20 t1\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TAME1'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                  \cf5\f4\fs20 t2\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TBME2'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                  \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DQ'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 True\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //cerca anche il DQ da squalifica\f0\cf0\i0 
\par                     \cf5\f4\fs20 DQSi\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 True\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                  \cf5\f4\fs20 DecodeTime\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 t1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 h1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 m1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 s1\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 z1\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                  \cf5\f4\fs20 t1n\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 h1\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 m1\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 s1\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 z1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                  \cf5\f4\fs20 DecodeTime\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 t2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 h2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 m2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 s2\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 z2\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                  \cf5\f4\fs20 t2n\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 h2\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 m2\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 s2\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 z2\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par                   \b\cf6\f5\fs20 if\f0\cf0\b0  \cf10\f9\fs20 ((((\f0\cf0 \cf5\f4\fs20 t1n\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0 \b\cf6\f5\fs20 and\f0\cf0\b0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 t2n\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 ))\f0\cf0 \b\cf6\f5\fs20 or\f0\cf0\b0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 tmcn\f0\cf0 \cf10\f9\fs20 >\f0\cf0 \cf5\f4\fs20 tmx\f0\cf0 \cf10\f9\fs20 ))\f0\cf0 \b\cf6\f5\fs20 or\f0\cf0\b0  \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 DQSi\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 True\f0\cf0 \cf10\f9\fs20 ))\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Assegna direttamente DQ\f0\cf0\i0 
\par                  \b\cf6\f5\fs20 begin\f0\cf0\b0                                     \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // e ranking alla T16\f0\cf0\i0 
\par                    \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DQ'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 True\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                    \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'RNK'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                    \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 tmx\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                  \b\cf6\f5\fs20 end\f0\cf0\b0  \b\cf6\f5\fs20 else\f0\cf0\b0 
\par                    \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                      \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'RNK'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0  \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 rn\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                     \cf5\f4\fs20 rn\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 rn\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                    \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Post\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 DQSi\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 False\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par            \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 >\f0\cf0 \cf7\f6\fs20 0\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0  \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'ABSQuery85/16 errore eof'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par 
\par            \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Ricostruisce Q85 Ordinata per Ranking decrescenti\f0\cf0\i0 
\par                \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQuery85\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par             \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par               \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'Select * from Ranking Order By "RNK" desc'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0           \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Ordina la Tabella 16 Ranking\f0\cf0\i0 
\par               \cf5\f4\fs20 Open\f0\cf0 
\par             \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par               \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Edit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Last\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 RecordCount\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EOF\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par               \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Insert\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMR'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMR'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'COGNOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'COGNOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPET'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPET'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPOS'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NMPOS'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TAME1'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TAME1'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TBME2'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TBME2'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DQ'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DQ'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'PEN'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'PEN'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'MANL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'MANL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CAT'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CAT'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'RNK'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'RNK'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 
\par                   \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par                 \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 qtrl\f0\cf0 \cf10\f9\fs20 -\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Post\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par                  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //  Aggiungo il nome e nazione\f0\cf0\i0 
\par          \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par          \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EOF\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par          \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par           \cf5\f4\fs20 CODATL16\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 ATLsi\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Locate\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 CODATL16\f0\cf0 \cf10\f9\fs20 ,[]\f0\cf0  \cf10\f9\fs20 );\f0\cf0 
\par           \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ATLsi\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 False\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0        \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //si blocca sul record con pari codice DSPL\f0\cf0\i0 
\par             \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par              \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Errore Atleta non trovato nell'\f0\cf0 \cf9\f8\fs20 'Anagrafica'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par              \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Edit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NAZIONE'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NAZIONE'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Post\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 NEXT\f0\cf0 
\par          \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par          \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // ci sono i DATI dei punti\f0\cf0\i0 
\par                 \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //TRASCRIZIONE su T16T  STORICO\f0\cf0\i0 
\par 
\par         \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // Form2.ABSTable16T.TableName:='T16T';\f0\cf0\i0 
\par          \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par          \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EOF\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par           \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                 \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Raccolta dati di codice\f0\cf0\i0 
\par            \cf5\f4\fs20 ca\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 dp\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 trovato\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Locate\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL;CODGA;CODDSPL'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 VarArrayOf\f0\cf0 \cf10\f9\fs20 ([\f0\cf0 \cf5\f4\fs20 intTostr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ca\f0\cf0 \cf10\f9\fs20 ),\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 ),\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 dp\f0\cf0 \cf10\f9\fs20 )]),[]);\f0\cf0 
\par             \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 trovato\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 False\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0   \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Insert\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Edit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ca\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 dp\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'COGNOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'COGNOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NAZIONE'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NAZIONE'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 TDateTimeField\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 )).\f0\cf0 \cf5\f4\fs20 DisplayFormat\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'RNK'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'RNK'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DQ'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DQ'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsBoolean\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CAT'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CAT'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Aggiunge dati mancanti\f0\cf0\i0 
\par             \cf5\f4\fs20 trovato\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable4\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Locate\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 dp\f0\cf0 \cf10\f9\fs20 ,[]);\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Descrizione\f0\cf0\i0 
\par             \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 trovato\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 True\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par               \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DESCR'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable4\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DESCR'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0  \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 dscrz\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable4\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DESCR'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \b\cf6\f5\fs20 end\f0\cf0\b0  \b\cf6\f5\fs20 else\f0\cf0\b0 
\par              \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par              \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Errore Disciplina non trovata nell'\f0\cf0 \cf9\f8\fs20 'Anagrafica @T16T'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par              \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 trovato\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable5\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Locate\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 ,[]);\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Data Gara\f0\cf0\i0 
\par             \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 trovato\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 True\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par              \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DATAGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable5\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'DATA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0  \b\cf6\f5\fs20 else\f0\cf0\b0 
\par              \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par              \cf5\f4\fs20 ShowMessage\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Errore Gara non trovata nell'\f0\cf0 \cf9\f8\fs20 'Anagrafica @T16T'\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par              \cf5\f4\fs20 Exit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par            \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Post\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ABSTable16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //determina il punteggio totale per atleta\f0\cf0\i0 
\par 
\par             \cf5\f4\fs20 ABSTable16R\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0         \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Resetta la R16R prima di caricarla da Ranking\f0\cf0\i0 
\par           \cf5\f4\fs20 ABSTable16R\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQueryR\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par           \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par            \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf9\f8\fs20 'INSERT INTO R16R SELECT * FROM Ranking'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par          \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 MessageDlg\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Desideri esaminare la Classifica della Disciplina   '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 
\par           \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 dp\f0\cf0 \cf10\f9\fs20 ))+\f0\cf0 \cf9\f8\fs20 #13\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 'Gara : '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 ))+\f0\cf0 \cf9\f8\fs20 '  ?'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mtconfirmation\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 mbYes\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mbNo\f0\cf0 \cf10\f9\fs20 ],\f0\cf0  \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \cf10\f9\fs20 =\f0\cf0  \cf5\f4\fs20 mrYes\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par              \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                \cf5\f4\fs20 frxReport16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Variables\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf9\f8\fs20 'desc'\f0\cf0 \cf10\f9\fs20 ]:=\f0\cf0 \cf5\f4\fs20 quotedstr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 dscrz\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                \cf5\f4\fs20 frxReport16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Variables\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf9\f8\fs20 'max'\f0\cf0 \cf10\f9\fs20 ]:=\f0\cf0  \cf5\f4\fs20 quotedstr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 TimeToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 tmx\f0\cf0 \cf10\f9\fs20 ));\f0\cf0 
\par                \cf5\f4\fs20 frxReport16\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ShowReport\f0\cf0 \cf10\f9\fs20 ;\f0\cf0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Classifiche per singole discipline\f0\cf0\i0 
\par              \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0       \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Dati da ABSTable16 (Ranking)\f0\cf0\i0 
\par 
\par         \cf5\f4\fs20 ABSQuery80\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Altra disciplina\f0\cf0\i0 
\par        \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //qu\u236?finiscono le discipline della Gara\f0\cf0\i0 
\par 
\par       \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 \i\cf2\f1\fs20 //adesso inserisce una nuova gara\f0\cf0\i0 
\par      \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par     \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ClassDP\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 True\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //realizzazione   REPORT COMPLESSIVI x DISCIPLINE\f0\cf0\i0 
\par     \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par       \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 Application\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 MessageBox\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Desideri esaminare la classifica di ciascuna Disciplina'\f0\cf0 
\par            \cf10\f9\fs20 +\f0\cf0  \cf9\f8\fs20 #13#10\f0\cf0  \cf10\f9\fs20 +\f0\cf0  \cf9\f8\fs20 '              per tutte le Gare selezionate ?'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf9\f8\fs20 'Conferma'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 
\par          \cf5\f4\fs20 MB_YESNO\f0\cf0  \cf10\f9\fs20 +\f0\cf0  \cf5\f4\fs20 MB_ICONQUESTION\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \cf10\f9\fs20 =\f0\cf0  \cf5\f4\fs20 IDNO\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0  \cf5\f4\fs20 Exit\f0\cf0  \b\cf6\f5\fs20 else\f0\cf0\b0 
\par       \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par         \cf5\f4\fs20 ABSTable20\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 eof\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Qu\u236?inizia il giro delle gare scelte\f0\cf0\i0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par           \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Codice'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 eof\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //qu\u236?inizia il giro delle discipline scelte\f0\cf0\i0 
\par           \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par             \cf5\f4\fs20 dp\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODDSPL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQueryR\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par             \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par               \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf9\f8\fs20 'INSERT INTO repDSPL'\f0\cf0  \cf10\f9\fs20 +\f0\cf0 
\par                           \cf9\f8\fs20 '(SELECT * FROM T16T'\f0\cf0  \cf10\f9\fs20 +\f0\cf0 
\par                           \cf9\f8\fs20 ' WHERE CODGA='\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 ))+\f0\cf0 \cf9\f8\fs20 'AND CODDSPL='\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 dp\f0\cf0 \cf10\f9\fs20 ))+\f0\cf0 \cf9\f8\fs20 ')'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 \i\cf2\f1\fs20 //adesso inserisce una nuova disciplina\f0\cf0\i0 
\par           \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 \i\cf2\f1\fs20 //adesso inserisce una nuova gara\f0\cf0\i0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //ho tutti i record con i TMC per le gare e discipline scelte.\f0\cf0\i0 
\par       \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //codifica molto complessa\f0\cf0\i0 
\par             \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQueryR\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par          \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par            \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'Select Min(repDSPL."DATAGA")as MinDataGa,Max(repDSPL."DATAGA")as maxDataGa from repDSPL'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par          \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 d1\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQueryR\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'MinDataGa'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 d2\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQueryR\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'maxDataGa'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par          \cf5\f4\fs20 durata\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 ' Gare dal  '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 DateToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 d1\f0\cf0 \cf10\f9\fs20 )+\f0\cf0 \cf9\f8\fs20 ' al  '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 DateToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 d2\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par 
\par          \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQueryRep\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par          \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par            \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'Select CODATL,CODDSPL,DESCR,COGNOME,NOME,NAZIONE,CAT,Sum(RNK) as RNK from repDSPL'\f0\cf0 \cf10\f9\fs20 +\f0\cf0 
\par            \cf9\f8\fs20 ' GROUP BY CODATL,CODDSPL,DESCR,COGNOME,NOME,NAZIONE,CAT ORDER by CODDSPL, RNK desc'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par          \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0               \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //report per disciplina per le gare selezionate\f0\cf0\i0 
\par 
\par          \cf5\f4\fs20 frxReport8D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Variables\f0\cf0 \cf10\f9\fs20 [\f0\cf0 \cf9\f8\fs20 'inifin'\f0\cf0 \cf10\f9\fs20 ]:=\f0\cf0 \cf5\f4\fs20 quotedstr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 durata\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par          \cf5\f4\fs20 frxReport8D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ShowReport\f0\cf0 \cf10\f9\fs20 ;\f0\cf0                                        \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //report COMPLESSIVO\f0\cf0\i0 
\par 
\par           \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQueryRep\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0            \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // punteggio complessivo\f0\cf0\i0 
\par          \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par            \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'Select CODATL,COGNOME,NOME,NAZIONE,Sum(RNK) as RNK from repDSPL'\f0\cf0 \cf10\f9\fs20 +\f0\cf0 
\par            \cf9\f8\fs20 ' GROUP BY CODATL,COGNOME,NOME,NAZIONE ORDER by RNK desc'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par          \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par          \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //inserisce in T19=totale i dati di ABSQueryRep con TMC blank\f0\cf0\i0 
\par          \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par          \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par          \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par          \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Edit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par          \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 first\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par          \cf5\f4\fs20 ABSQueryRep\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 ABSQueryRep\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Eof\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par          \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par            \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Insert\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQueryRep\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'COGNOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQueryRep\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'COGNOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQueryRep\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NAZIONE'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQueryRep\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NAZIONE'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'RNK'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQueryRep\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'RNK'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Post\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 ABSQueryRep\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par          \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par          \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //colleziona i tempi da RepDSPL\f0\cf0\i0 
\par          \cf5\f4\fs20 t1\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par          \cf5\f4\fs20 ca\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par          \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // Totale\f0\cf0\i0 
\par            \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 eof\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par           \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par               \cf5\f4\fs20 ca\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 ABSTable20\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 ABSTable20\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 eof\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par              \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                \b\cf6\f5\fs20 if\f0\cf0\b0  \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ca\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 ABSTable20\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 )\f0\cf0   \b\cf6\f5\fs20 then\f0\cf0\b0 
\par                \cf5\f4\fs20 t1\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 t1\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 TimeOf\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ABSTable20\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                \cf5\f4\fs20 ABSTable20\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Edit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 TDateTimeField\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 )).\f0\cf0 \cf5\f4\fs20 DisplayFormat\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 t1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Assegna il tmc totale all'atleta\f0\cf0\i0 
\par              \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Post\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 t1\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par             \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQueryRep\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par              \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf9\f8\fs20 'Select * from totale Order by RNK desc,TMC asc'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par          \cf5\f4\fs20 frxReportCompl\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ShowReport\f0\cf0 \cf10\f9\fs20 ;\f0\cf0           \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // report punteggio complessivo\f0\cf0\i0 
\par 
\par     \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par      \b\cf6\f5\fs20 if\f0\cf0\b0  \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ClassDp\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 False\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par     \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par        \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par         \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 eof\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Qu\u236?inizia il giro delle gare scelte\f0\cf0\i0 
\par      \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par        \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Codice'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 MessageDlg\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 ' Desideri esaminare la Classifica Riepilogativa '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 
\par         \cf9\f8\fs20 'della Gara : '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 ))+\f0\cf0 \cf9\f8\fs20 #13\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 ' per tutte le discipline praticate ?'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mtconfirmation\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 mbYes\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mbNo\f0\cf0 \cf10\f9\fs20 ],\f0\cf0  \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \cf10\f9\fs20 =\f0\cf0  \cf5\f4\fs20 mrYes\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par        \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par           \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQueryRep\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par           \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par            \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'Select * from T16T Where CODGA = '\f0\cf0 \cf10\f9\fs20 +\f0\cf0  \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 ))+\f0\cf0 \cf9\f8\fs20 ' Order by CODDSPL, RNK desc'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par                \cf5\f4\fs20 frxReport16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ShowReport\f0\cf0 \cf10\f9\fs20 ;\f0\cf0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Classifica riepilogativa gara\f0\cf0\i0 
\par           \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQuery85\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0       \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Dati da QueryRep\f0\cf0\i0 
\par           \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par            \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //tabelle con nome numerico devono iniziare con una lettera\f0\cf0\i0 
\par            \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'Select CODATL,COGNOME,NOME,DATAGA, sum(RNK) AS TOTRNK from T16T Where CODGA = '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 
\par            \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 ))+\f0\cf0 \cf9\f8\fs20 ' Group By CODATL,COGNOME,NOME,DATAGA Order by TOTRNK desc'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 Open\f0\cf0 
\par           \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 frxReport16T2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ShowReport\f0\cf0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // Classifica riepilogativa punteggio\f0\cf0\i0 
\par        \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0          \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Dati da Query85 >> 16T (T16T)\f0\cf0\i0 
\par          \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par     \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par 
\par     \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 ClassDp\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 False\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par      \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par 
\par         \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 MessageDlg\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 ' Desideri esaminare Il Punteggio complessivo raggiunto '\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 #13\f0\cf0 
\par            \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 ' per le Gare selezionate ?'\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf9\f8\fs20 #13\f0\cf0 \cf10\f9\fs20 +\f0\cf0 
\par            \cf9\f8\fs20 'NB. Non cambia per una sola Gara'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mtconfirmation\f0\cf0 \cf10\f9\fs20 ,\f0\cf0  \cf10\f9\fs20 [\f0\cf0 \cf5\f4\fs20 mbYes\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 mbNo\f0\cf0 \cf10\f9\fs20 ],\f0\cf0  \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 )\f0\cf0  \cf10\f9\fs20 =\f0\cf0  \cf5\f4\fs20 mrYes\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par         \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par          \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par          \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Edit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par          \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par           \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Eof\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par            \b\cf6\f5\fs20 begin\f0\cf0\b0            \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Colleziona i dati di tutte le gare scelte\f0\cf0\i0 
\par             \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'codice'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQueryRep\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par              \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'Select CODATL,COGNOME, NOME,NAZIONE, SUM(RNK) AS TOTRNK from T16T Where CODGA = '\f0\cf0 
\par                \cf10\f9\fs20 +\f0\cf0  \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 ))+\f0\cf0 \cf9\f8\fs20 'AND  CAT ='\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 QuotedStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 IntToStr\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ct\f0\cf0 \cf10\f9\fs20 ))+\f0\cf0 \cf9\f8\fs20 ' Group By CODATL,COGNOME,NOME,NAZIONE '\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par               \cf5\f4\fs20 ABSQueryRep\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 ABSQueryRep\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 eof\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par               \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                 \cf5\f4\fs20 temp2\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQueryRep\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 trovato\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Locate\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf5\f4\fs20 temp2\f0\cf0 \cf10\f9\fs20 ,[]);\f0\cf0 
\par                   \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 trovato\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 False\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par                     \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Insert\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Edit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQueryRep\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'COGNOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQueryRep\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'COGNOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQueryRep\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NOME'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NAZIONE'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSQueryRep\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'NAZIONE'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 tt\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 ABSQueryRep\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TOTRNK'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 tt2\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'RNK'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'RNK'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 tt\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 tt2\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Post\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 ABSQueryRep\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par               \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par             \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par                           \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //tentativo di totalizzazione TMC  - Codice aggiunto\f0\cf0\i0 
\par            \cf5\f4\fs20 t1\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //inizializzazione variabili\f0\cf0\i0 
\par            \cf5\f4\fs20 ca\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 eof\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par            \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par               \cf5\f4\fs20 ca\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Eof\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par                 \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                   \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'codice'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                     \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 First\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                     \b\cf6\f5\fs20 while\f0\cf0\b0  \b\cf6\f5\fs20 not\f0\cf0\b0  \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 eof\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par                     \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                        \b\cf6\f5\fs20 if\f0\cf0\b0  \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ca\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODATL'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 )\f0\cf0 \b\cf6\f5\fs20 and\f0\cf0\b0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ga\f0\cf0 \cf10\f9\fs20 =\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'CODGA'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsInteger\f0\cf0 \cf10\f9\fs20 )\f0\cf0   \b\cf6\f5\fs20 then\f0\cf0\b0 
\par                         \cf5\f4\fs20 t1\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 t1\f0\cf0 \cf10\f9\fs20 +\f0\cf0 \cf5\f4\fs20 TimeOf\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par                        \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable16T\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                     \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par                   \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                 \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Edit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 TDateTimeField\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 )).\f0\cf0 \cf5\f4\fs20 DisplayFormat\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf9\f8\fs20 'nn:ss,zzz'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'TMC'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 t1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Assegna il tmc totale all'atleta\f0\cf0\i0 
\par              \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Post\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 t1\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Next\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par            \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0                    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Fine codice aggiunto\f0\cf0\i0 
\par 
\par 
\par 
\par                \b\cf6\f5\fs20 with\f0\cf0\b0  \cf5\f4\fs20 ABSQueryRep\f0\cf0  \b\cf6\f5\fs20 do\f0\cf0\b0 
\par              \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par                \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 SQL\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Text\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf9\f8\fs20 'Select * from totale Order by RNK desc,TMC asc'\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 ExecSQL\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par              \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par              \cf5\f4\fs20 frxReportTot\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ShowReport\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par                                 \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //dati da QueryRep >> Totale T19\f0\cf0\i0 
\par         \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par     \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par   \b\cf6\f5\fs20 end\f0\cf0\b0  \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 ClassDp\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 False\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 RadioButton1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Checked\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 False\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 RadioButton1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 RadioButton2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Checked\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 False\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 RadioButton2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 RadioButton3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Checked\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 False\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 RadioButton3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 Shape1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Brush\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Azzera e resetta la scelta Gare nell'Array\f0\cf0\i0 
\par        \cf5\f4\fs20 SetLength\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par        \cf5\f4\fs20 SetLength\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf7\f6\fs20 20\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par        \cf5\f4\fs20 Shape2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Brush\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0  \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Azzera e resetta la scelta Discipline nell'Array\f0\cf0\i0 
\par        \cf5\f4\fs20 SetLength\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArDspl\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par        \cf5\f4\fs20 SetLength\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArDspl\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf7\f6\fs20 20\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par        \cf5\f4\fs20 Shape3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Brush\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Color\f0\cf0 \cf10\f9\fs20 :=\f0\cf0  \cf5\f4\fs20 clRed\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 ComboBox1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ItemIndex\f0\cf0 \cf10\f9\fs20 :=-\f0\cf0 \cf7\f6\fs20 1\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 ABSTable19\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 ABSTable18\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 ABSTable18\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 Dbgrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 DataSource\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 DataSet\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 Dbgrid8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Refresh\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 Form8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EsciClick\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 self\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par 
\par \b\cf6\f5\fs20 procedure\f0\cf0\b0  \cf5\f4\fs20 TForm8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EsciClick\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 Sender\f0\cf0 \cf10\f9\fs20 :\f0\cf0  \cf5\f4\fs20 TObject\f0\cf0 \cf10\f9\fs20 );\f0\cf0     \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //Esci\f0\cf0\i0 
\par \b\cf6\f5\fs20 begin\f0\cf0\b0 
\par       \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Open\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Last\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \b\cf6\f5\fs20 if\f0\cf0\b0  \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'Password'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsString\f0\cf0 \cf10\f9\fs20 <>\f0\cf0 \cf9\f8\fs20 ''\f0\cf0  \b\cf6\f5\fs20 then\f0\cf0\b0 
\par        \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Insert\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Edit\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 FieldByName\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf9\f8\fs20 'OUT'\f0\cf0 \cf10\f9\fs20 ).\f0\cf0 \cf5\f4\fs20 AsDateTime\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 NOW\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Post\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par        \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable1\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \cf5\f4\fs20 Form8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Visible\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 False\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \cf5\f4\fs20 Form8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0    \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 // NB chiama il can close\f0\cf0\i0 
\par       \cf5\f4\fs20 ClassFlg\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 True\f0\cf0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //per consentire di monitorizzare che Form8 \u232?closed\f0\cf0\i0 
\par       \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Visible\f0\cf0 \cf10\f9\fs20 :=\f0\cf0 \cf5\f4\fs20 True\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \cf5\f4\fs20 SetLength\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArGare\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par       \cf5\f4\fs20 SetLength\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArDspl\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par       \cf5\f4\fs20 SetLength\f0\cf0 \cf10\f9\fs20 (\f0\cf0 \cf5\f4\fs20 ArCat\f0\cf0 \cf10\f9\fs20 ,\f0\cf0 \cf7\f6\fs20 0\f0\cf0 \cf10\f9\fs20 );\f0\cf0 
\par       \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //resetta la tabella SelezioneGare\f0\cf0\i0 
\par       \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable3D\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //resetta la tabella SelezioneDSPL\f0\cf0\i0 
\par       \cf5\f4\fs20 ABSQuery85\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0  \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //per consentire lo svuotamento messo su ObjInsp Exclusive=True\f0\cf0\i0 
\par       \cf5\f4\fs20 ABSTable15\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0   \cf10\f9\fs20 \f0\cf0 \i\cf2\f1\fs20 //resetta la tabella  Classifica\f0\cf0\i0 
\par       \cf5\f4\fs20 ABSTable16R\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable4\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable5\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable6\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable8\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \cf5\f4\fs20 Form2\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 ABSTable9\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \cf5\f4\fs20 ABSTable20\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 Close\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par       \cf5\f4\fs20 ABSTable20\f0\cf0 \cf10\f9\fs20 .\f0\cf0 \cf5\f4\fs20 EmptyTable\f0\cf0 \cf10\f9\fs20 ;\f0\cf0 
\par \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 ;\f0\cf0 
\par \b\cf6\f5\fs20 end\f0\cf0\b0 \cf10\f9\fs20 .\f0\cf0 
\par 
}
